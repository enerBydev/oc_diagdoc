---
id: 3.1.4.2
title: Tablas Relacionales
parent: 3.1.4
breadcrumb: 0 → 3.0 → 3.1 → 3.1.4 → 3.1.4.2
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-05 12:30
domain:
- sql
- tablas
- relaciones
actors:
- admin
- desarrollador
summary: 'Tablas pivote y relacionales: paquete_servicios, escalas_volumen, escala_rangos.'
content_hash: f9aa347b2515c388
---

# 3.1.4.2 Tablas Relacionales

> Tablas de relación M:N y escalas de volumen para B2B.

---

## paquete_servicios

Relación muchos a muchos entre paquetes y servicios.

```sql
CREATE TABLE paquete_servicios (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  paquete_id UUID NOT NULL REFERENCES paquetes(id) ON DELETE CASCADE,
  servicio_id UUID NOT NULL REFERENCES servicios(id) ON DELETE RESTRICT,
  es_adicional BOOLEAN DEFAULT false,
  orden INTEGER DEFAULT 0,
  UNIQUE(paquete_id, servicio_id)
);

CREATE INDEX idx_paquete_servicios_paquete ON paquete_servicios(paquete_id);
```

---

## escalas_volumen

Definición de escalas de descuento por volumen.

```sql
CREATE TABLE escalas_volumen (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  codigo VARCHAR(50) NOT NULL UNIQUE,
  nombre VARCHAR(100) NOT NULL,
  descripcion TEXT,
  activo BOOLEAN DEFAULT true
);
```

---

## escala_rangos

Rangos de cada escala con descuentos aplicables.

```sql
CREATE TABLE escala_rangos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  escala_id UUID NOT NULL REFERENCES escalas_volumen(id) ON DELETE CASCADE,
  min_vehiculos INTEGER NOT NULL CHECK (min_vehiculos > 0),
  max_vehiculos INTEGER, -- NULL = sin límite
  descuento DECIMAL(5,2) NOT NULL CHECK (descuento >= 0 AND descuento <= 100),
  UNIQUE(escala_id, min_vehiculos)
);
```

---

## Navegación

| ⬆️ Padre | [[Proyecto OnlyCarNLD/Datos/3.1.4 esquema_sql_logica_negocio]] |
|----------|--------------------------------------|
| ⬅️ Anterior | [[Proyecto OnlyCarNLD/Datos/3.1.4.1 Tablas_Core]] |
| ➡️ Siguiente | [[Proyecto OnlyCarNLD/Datos/3.1.4.3 Tablas_Descuentos]] |

---
