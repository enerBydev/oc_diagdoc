---
id: 2.8.6
title: Security Headers
parent: '2.8'
breadcrumb: 0 → 2.0 → 2.8 → 2.8.6
type: configuracion
children_count: 0
descendants_count: 0
status: activo
domain:
- seguridad
- headers
- csp
- cors
actors:
- desarrollador
- devops
summary: 'Headers de seguridad HTTP: CSP, HSTS, X-Frame-Options, CORS policy y configuración
  en Nuxt/Cloudflare.'
last_updated: 2026-01-29 15:31
file_create: 2026-01-22 23:10
content_hash: 95095ec3922d22da
---

# 2.8.6 Security Headers

> Headers HTTP que protegen contra ataques comunes del lado del cliente.

---

## Headers Obligatorios

| Header | Valor | Protección |
|--------|-------|------------|
| `Strict-Transport-Security` | `max-age=31536000; includeSubDomains` | HTTPS forzado |
| `X-Content-Type-Options` | `nosniff` | MIME sniffing |
| `X-Frame-Options` | `DENY` | Clickjacking |
| `X-XSS-Protection` | `1; mode=block` | XSS (legacy) |
| `Referrer-Policy` | `strict-origin-when-cross-origin` | Info leaks |

---

## Content Security Policy (CSP)

```http
Content-Security-Policy: 
  default-src 'self';
  script-src 'self' 'unsafe-inline' https://js.stripe.com https://www.googletagmanager.com;
  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
  img-src 'self' data: https://*.supabase.co https://*.cloudflare.com;
  font-src 'self' https://fonts.gstatic.com;
  connect-src 'self' https://*.supabase.co wss://*.supabase.co https://api.stripe.com;
  frame-src https://js.stripe.com https://hooks.stripe.com;
  object-src 'none';
  base-uri 'self';
```

---

## Configuración en Nuxt

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  routeRules: {
    '/**': {
      headers: {
        'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',
        'X-Content-Type-Options': 'nosniff',
        'X-Frame-Options': 'DENY',
        'X-XSS-Protection': '1; mode=block',
        'Referrer-Policy': 'strict-origin-when-cross-origin'
      }
    }
  }
})
```

---

## CORS Configuration

```typescript
// server/middleware/cors.ts
export default defineEventHandler((event) => {
  const allowedOrigins = [
    'https://onlycar.mx',
    'https://app.onlycar.mx',
    'capacitor://localhost', // Mobile
    'http://localhost:3000'  // Dev
  ];
  
  const origin = getHeader(event, 'origin');
  
  if (origin && allowedOrigins.includes(origin)) {
    setHeader(event, 'Access-Control-Allow-Origin', origin);
    setHeader(event, 'Access-Control-Allow-Credentials', 'true');
    setHeader(event, 'Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
    setHeader(event, 'Access-Control-Allow-Headers', 'Content-Type, Authorization');
  }
});
```

---

## Verificación

```bash
# Escanear headers de seguridad
curl -I https://onlycar.mx | grep -E "(Strict|X-|Content-Security)"

# Herramienta online
# https://securityheaders.com/?q=onlycar.mx
```

**Score Objetivo:** A+ en securityheaders.com

---

## Relaciones

- Complementa: [[Proyecto OnlyCarNLD/Datos/2.8.3 WAF_Configuration|Reglas WAF]]
- Configura: [[Proyecto OnlyCarNLD/Datos/2.1.1 Nuxt_Configuration|nuxt.config.ts]]
- Protege: [[Proyecto OnlyCarNLD/Datos/2.5. Arquitectura_Frontend|Frontend]]

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.8. Seguridad_Infraestructura]] |
| -------------------- | ---------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.8.5 DDOS_Protection]]          |
| ➡️ Hermano siguiente | *(Último hijo de 2.8)*             |

---
