---
id: 2.1.2
title: Capacitor Bridge
parent: '2.1'
breadcrumb: 0 → 2.0 → 2.1 → 2.1.2
type: especificacion
domain:
- capacitor
- bridge
- native
- jsi
- webview
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-05 03:15
summary: 'Arquitectura del puente de comunicación JS <-> Nativo.

  Inyección de Webview, manejo de hilos y serialización.'
content_hash: 2de911591054a915
---

# 2.1.2 Capacitor Bridge

> Cómo JavaScript habla con Swift (iOS) y Kotlin (Android).

---

## Arquitectura del Bridge

El Capacitor Bridge no es un simple iframe. Es una inyección de APIs en el `window` global del Webview.

### Flujo de Llamada (Plugin Call)

1.  **Js Layer:** `Geolocation.getCurrentPosition()`
2.  **Serialization:** Se empaqueta la petición en JSON. `{ plugin: 'Geolocation', method: 'getLocation', data: {} }`
3.  **Bridge Transport:**
    *   **iOS:** `WKScriptMessageHandler`
    *   **Android:** `@JavascriptInterface`
4.  **Native Execution:** El hilo principal nativo recibe el mensaje y lo despacha al Plugin class.
5.  **Thread Hop:** Operaciones pesadas (GPS) se mueven a un *background thread* para no congelar la UI.
6.  **Callback:** El resultado regresa vía `eval()` o inyección JS directa.

---

## Consideraciones de Rendimiento

El paso de mensajes tiene un costo (overhead de serialización).
*   **Anti-Patrón:** Enviar imágenes base64 gigantes por el bridge.
*   **Solución:** Guardar archivo en disco nativo y pasar solo el `file://path` a JS.

### Capacitor vs React Native Bridge
Capacitor es más moderno en su enfoque de mantener la UI 100% Web, usando el bridge solo para "Capabilities", mientras RN usa el bridge para renderizado de UI (más pesado).

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.1. FullStack]]              |
| -------------------- | ------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.1.1 Nuxt_Configuration]]    |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.1.3 Cloudflare_Architecture]]|

---
