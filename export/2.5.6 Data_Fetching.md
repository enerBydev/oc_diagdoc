---
id: 2.5.6
title: Data Fetching
parent: '2.5'
breadcrumb: 0 → 2.0 → 2.5 → 2.5.6
type: arquitectura
status: activo
domain:
- nuxt
- api
- data-fetching
- caching
summary: 'Patrones de consumo de API en Nuxt 4: useFetch vs useAsyncData, estrategias
  de Caching, Deduplicación y Serialización.'
last_updated: 2026-01-29 15:32
content_hash: 95c8dd5060dd3cc7
---

# 2.5.6 Data Fetching

> Estrategias para obtener datos del servidor de manera eficiente, segura y optimizada para SSR/CSR.

---

## Estructura de Hijos

| ID | Nombre | Descripción | Estado |
|----|--------|-------------|--------|
| [[Proyecto OnlyCarNLD/Datos/2.5.6.1 Optimistic_Updates\|2.5.6.1]] | Optimistic Updates | UX instantánea | ✅ |
| [[Proyecto OnlyCarNLD/Datos/2.5.6.2 Infinite_Scroll\|2.5.6.2]] | Infinite Scroll | Paginación por cursor | ✅ |

---

## Composables Principales

Nuxt provee wrappers potentes sobre `ofetch`.

### `useFetch`
La herramienta por defecto para obtener datos en componentes/páginas.
- **SSR Friendly**: Ejecuta en servidor, hidrata en cliente.
- **Auto-importado**: Disponible globalmente.
- **Reactivo**: Refresca automáticamente si cambian sus dependencias (params, query).

```typescript
const { data, pending, error } = await useFetch('/api/servicios', {
  query: { category: selectedCategory }, // Reactivo
  pick: ['id', 'title', 'price'], // Optimización de payload
});
```

### `useAsyncData`
Para cuando necesitas ejecutar lógica asíncrona compleja que no es solo un fetch directo, o para agrupar múltiples llamadas.

### `$fetch`
Para acciones iniciadas por el usuario (POST, PUT, DELETE) donde no necesitamos hidratación SSR.
*Usar en: Submit de formularios, botones de acción.*

---

## Estrategia de Caching y Deduplicación

### Claves (Keys)
Nuxt genera keys automáticas basadas en el archivo y línea. Para caching manual robusto, definir keys explícitas:

```typescript
useFetch('/api/config', { key: 'app-global-config' })
```

### `getCachedData`
Permite retornar datos cacheados si son recientes, evitando llamadas innecesarias a la API en navegaciones client-side.

```typescript
useFetch('/api/menu', {
  getCachedData(key) {
    const data = nuxtApp.payload.data[key] || nuxtApp.static.data[key];
    if (!data) return;
    // Lógica de expiración custom si es necesario
    return data;
  }
});
```

---

## Manejo de Estados

### Skeleton Loading
Mientras `pending` es `true`, mostrar una versión esqueleto del componente para mejorar la percepción de velocidad (CLS reduction).

### Error Handling
No dejar que el error rompa la aplicación.
- Usar `<NuxtErrorBoundary>` para aislar fallos.
- Mostrar "Estados Vacíos" o "Error de Conexión" amigables con botón de "Reintentar" (`refresh()`).

---

## Serialización (SuperJson)

Para transmitir tipos complejos (Date, Set, Map, BigInt) desde el servidor (Nitro) al cliente (Vue) sin perder el tipo, utilizamos serialización avanzada automática integrada en Nuxt.
*Esto evita que las Fechas lleguen como Strings.*

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.5. Arquitectura_Frontend]] |
| -------------------- | ------------------------------ |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.5.5 Logica_Formularios]]   |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.5.7 SEO_Performance]]      |

---
