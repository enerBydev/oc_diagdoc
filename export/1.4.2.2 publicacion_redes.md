---
id: 1.4.2.2
title: Publicaci√≥n en Redes Sociales
parent: 1.4.2
breadcrumb: 0 ‚Üí 1.0 ‚Üí 1.4 ‚Üí 1.4.2 ‚Üí 1.4.2.2
type: feature
status: activo
last_updated: 2026-01-29 16:01
file_create: 2026-01-10 01:12
domain:
- marketing
- redes_sociales
- testimonios
actors:
- admin
summary: Flujo de publicaci√≥n de testimonios en redes sociales. Meta Business Suite,
  templates, scheduler.
content_hash: 9d515b9be54578c8
---

# 1.4.2.2 Publicaci√≥n en Redes Sociales

> Sistema para publicar testimonios aprobados en Instagram y Facebook.

---

## Flujo de Publicaci√≥n

```mermaid
sequenceDiagram
    participant A as Admin
    participant T as Testimonios
    participant M as Meta API
    participant I as Instagram
    participant F as Facebook
    
    A->>T: Aprobar testimonio
    T->>T: Marcar para publicar
    A->>T: Seleccionar template
    T->>T: Generar imagen
    A->>T: Programar fecha/hora
    T->>M: POST /media
    M->>I: Publicar post
    M->>F: Publicar post
    M-->>T: Respuesta con IDs
    T->>T: Guardar referencias
```

---

## Templates de Publicaci√≥n

### Instagram Story

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                ‚îÇ
‚îÇ     ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê                 ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ   "Excelente servicio,         ‚îÇ
‚îÇ    mi auto qued√≥ como          ‚îÇ
‚îÇ    nuevo."                     ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ         ‚Äî Juan G.              ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ   üöó OnlyCar                ‚îÇ
‚îÇ   Limpieza vehicular           ‚îÇ
‚îÇ   a domicilio                  ‚îÇ
‚îÇ                                ‚îÇ
‚îÇ   [Agenda tu servicio]         ‚îÇ
‚îÇ                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Instagram Feed

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                            ‚îÇ
‚îÇ  [Imagen del auto limpio o logo]           ‚îÇ
‚îÇ                                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                            ‚îÇ
‚îÇ  "Excelente servicio, mi auto qued√≥        ‚îÇ
‚îÇ   como nuevo. Carlos fue muy profesional   ‚îÇ
‚îÇ   y puntual."                              ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ  ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‚Äî Juan G.                       ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ  #OnlyCar #LimpiezaVehicular            ‚îÇ
‚îÇ  #DetallsAutoLA gente                      ‚îÇ
‚îÇ                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Facebook Post

```
üåü CLIENTE SATISFECHO üåü

"Excelente servicio, mi auto qued√≥ como nuevo. 
Carlos fue muy profesional y puntual."

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‚Äî Juan G.

¬øQuieres tu auto as√≠ de reluciente? 
üëâ Agenda en onlycar.mx

#OnlyCar #LimpiezaVehicular #ClienteFeliz
```

---

## UI de Publicaci√≥n

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üì± PUBLICAR EN REDES                                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  TESTIMONIO                                                     ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Juan Garc√≠a                                          ‚îÇ
‚îÇ  "Excelente servicio, mi auto qued√≥ como nuevo..."              ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  PLATAFORMAS                                                    ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚òë Instagram Feed                                               ‚îÇ
‚îÇ  ‚òë Instagram Story                                              ‚îÇ
‚îÇ  ‚òë Facebook                                                     ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  TEMPLATE                                                       ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚óã Minimalista   ‚óè Con estrellas   ‚óã Con foto                   ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  PREVIEW                                                        ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  [Vista previa del post generado]                               ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  PROGRAMAR                                                      ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  Fecha: [15 Ene 2026]  Hora: [10:00]                            ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  [ Cancelar ]  [ Publicar ahora ]  [ Programar ]                ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Integraci√≥n Meta Business Suite

```typescript
// lib/meta-publishing.ts
import { Configuration, ContentPublishingApi } from 'meta-business-sdk';

const meta = new ContentPublishingApi(new Configuration({
  accessToken: process.env.META_ACCESS_TOKEN,
}));

export const publicarTestimonio = async (
  testimonio: Testimonio,
  opciones: PublicacionOpciones
) => {
  const { plataformas, template, programar } = opciones;
  
  // Generar imagen con template
  const imagenUrl = await generarImagen(testimonio, template);
  
  const resultados: PublicacionResultado[] = [];
  
  if (plataformas.instagramFeed) {
    const result = await meta.createMediaContainer({
      igUserId: process.env.IG_USER_ID,
      imageUrl: imagenUrl,
      caption: generarCaption(testimonio),
      scheduledPublishTime: programar?.getTime() / 1000,
    });
    resultados.push({ plataforma: 'instagram_feed', id: result.id });
  }
  
  if (plataformas.facebook) {
    const result = await meta.createPagePost({
      pageId: process.env.FB_PAGE_ID,
      message: generarPostFB(testimonio),
      link: 'https://onlycar.mx',
      scheduledPublishTime: programar?.getTime() / 1000,
    });
    resultados.push({ plataforma: 'facebook', id: result.id });
  }
  
  return resultados;
};
```

---

## Generaci√≥n de Imagen

```typescript
// lib/image-generator.ts
import { createCanvas, loadImage } from 'canvas';

export const generarImagen = async (
  testimonio: Testimonio,
  template: 'minimal' | 'stars' | 'photo'
): Promise<string> => {
  const canvas = createCanvas(1080, 1080);
  const ctx = canvas.getContext('2d');
  
  // Fondo
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, 1080, 1080);
  
  // Estrellas
  ctx.font = '48px Arial';
  ctx.fillText('‚≠ê'.repeat(testimonio.estrellas), 100, 200);
  
  // Texto
  ctx.font = '36px Georgia';
  ctx.fillStyle = '#333333';
  wrapText(ctx, `"${testimonio.texto}"`, 100, 300, 880, 50);
  
  // Autor
  ctx.font = '28px Arial';
  ctx.fillStyle = '#666666';
  ctx.fillText(`‚Äî ${testimonio.nombre_display}`, 100, 800);
  
  // Logo
  const logo = await loadImage('./assets/logo.png');
  ctx.drawImage(logo, 100, 900, 200, 80);
  
  // Subir a Cloudflare R2
  const buffer = canvas.toBuffer('image/png');
  const url = await uploadToR2(buffer, `testimonios/${testimonio.id}.png`);
  
  return url;
};
```

---

## Modelo de Datos

```sql
CREATE TABLE publicaciones_redes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  testimonio_id UUID REFERENCES testimonios(id),
  
  -- Plataforma
  plataforma VARCHAR(30), -- 'instagram_feed', 'instagram_story', 'facebook'
  external_id VARCHAR(100), -- ID de Meta
  
  -- Estado
  estado VARCHAR(20) DEFAULT 'pendiente',
  -- pendiente, programado, publicado, fallido
  
  -- Programaci√≥n
  programado_para TIMESTAMPTZ,
  publicado_at TIMESTAMPTZ,
  
  -- M√©tricas (actualizadas por webhook)
  likes INTEGER DEFAULT 0,
  comentarios INTEGER DEFAULT 0,
  compartidos INTEGER DEFAULT 0,
  alcance INTEGER DEFAULT 0,
  
  created_at TIMESTAMPTZ DEFAULT now()
);
```

---

## Autorizaci√≥n del Cliente

> [!IMPORTANT]
> Antes de publicar en redes, verificar que el cliente autoriz√≥ uso en redes sociales.

```sql
-- En tabla testimonios
publicar_redes BOOLEAN DEFAULT false
```

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre | [[Proyecto OnlyCarNLD/Datos/1.4.2 testimonios_marketing]] |
|----------|---------------------------------|
| ‚¨ÖÔ∏è Hermano anterior | [[Proyecto OnlyCarNLD/Datos/1.4.2.1 widget_testimonios]] |

---
