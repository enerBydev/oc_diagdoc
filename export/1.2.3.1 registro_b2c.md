---
id: 1.2.3.1
title: Registro B2C
parent: 1.2.3
breadcrumb: 0 ‚Üí 1.0 ‚Üí 1.2 ‚Üí 1.2.3 ‚Üí 1.2.3.1
type: flujo
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-09 12:30
domain:
- cliente
- registro
- oauth
- onboarding
- seguridad
summary: 'Flujo detallado de alta de usuarios B2C mediante OAuth (Google/Apple) y
  Email.

  Incluye l√≥gica de detecci√≥n de usuarios corporativos, validaciones de seguridad

  y proceso de onboarding inicial paso a paso.

  '
content_hash: fc709775181ca9a2
---

# 1.2.3.1 Registro B2C

> **Prop√≥sito:** Convertir visitantes en usuarios registrados con la menor fricci√≥n posible, garantizando la veracidad de los datos y detectando oportunidades B2B.

---

## 1. Estrategia de "Fricci√≥n M√≠nima"

El registro se presenta **solo cuando es necesario**. El usuario puede navegar precios y servicios como "invitado", pero se requiere cuenta para agendar.

**Principios UX:**
1.  **OAuth First:** Promover Google/Apple Sign-in (90% de conversi√≥n).
2.  **Progressive Profiling:** Pedir solo Email/Nombre al inicio. Tel√©fono y veh√≠culo se piden en el primer agendamiento.
3.  **Auto-detecci√≥n B2B:** Si el email es `@empresa.com` y existe contrato, sugerir cambio a perfil Corporate+.

---

## 2. Diagrama de Flujo Detallado

```mermaid
flowchart TD
    Start[Usuario inicia Registro] --> AuthMethod{¬øM√©todo?}
    
    %% OAuth Flow
    AuthMethod -->|Google/Apple| OAuth[Solicitar Token Provider]
    OAuth -->|Token OK| CheckUser{¬øExiste Usuario?}
    CheckUser -->|S√≠| LoginSuccess[Login Exitoso]
    CheckUser -->|No| CreateProfile[Crear Perfil Base]
    
    %% Email Flow
    AuthMethod -->|Email Manual| Form[Formulario Email+Pass]
    Form --> Validate[Validar Formato y Password]
    Validate --> SendVerif[Enviar Email Verificaci√≥n]
    SendVerif --> WaitVerif[Esperar Click Link]
    WaitVerif --> CreateProfile
    
    %% Post-Creation Logic
    CreateProfile --> CheckDomain{¬øDominio Corporativo?}
    CheckDomain -->|S√≠, existe contrato| SuggestCorp[Modal: ¬°Tienes beneficios Corp!]
    SuggestCorp -->|Aceptar| SwitchCorp[Cambiar rol a Corporate+]
    SuggestCorp -->|Ignorar| WelcomeB2C
    CheckDomain -->|No| WelcomeB2C[Onboarding B2C]
    
    SwitchCorp --> Onboarding
    WelcomeB2C --> Onboarding[Tutorial R√°pido 3 pasos]
    Onboarding --> End[Dashboard Cliente]
```

---

## 3. Validaciones y Seguridad

### 3.1 Requisitos de Contrase√±a (Flujo Manual)
Si el usuario elige email/password, se exige:
- M√≠nimo 8 caracteres.
- Al menos 1 n√∫mero.
- No coincidir con el email.
*Feedback en tiempo real: "Fuerza de contrase√±a: Media".*

### 3.2 Verificaci√≥n de Identidad
- **Email:** Obligatorio confirmar para evitar cuentas basura y asegurar canal de notificaciones (facturas).
- **Tel√©fono:** Se valida v√≠a OTP (SMS) **antes de la primera cita** para asegurar contacto operativo. No bloquea el registro inicial, pero s√≠ la primera compra (Lazy Verification).

---

## 4. Manejo de Errores (Edge Cases)

| Escenario | Comportamiento del Sistema | Mensaje al Usuario |
|-----------|----------------------------|--------------------|
| **Email ya registrado (OAuth)** | Autoconectar cuentas (Merge). | "Ya ten√≠as cuenta con este email, te hemos logueado." |
| **Email ya registrado (Manual)** | Bloquear registro. | "Este correo ya existe. ¬øOlvidaste tu contrase√±a?" |
| **Fallo OAuth (Red/Provider)** | Fallback a login manual. | "No pudimos conectar con Google. Por favor intenta con email." |
| **Link verificaci√≥n expirado** | Generar nuevo link autom√°tico. | "El enlace caduc√≥. Te hemos enviado uno nuevo." |

---

## 5. Detecci√≥n Corporativa (Growth Hack)

El sistema consulta una lista blanca de dominios B2B (ej. `@cemex.com`, `@femsa.com`) al registrarse.

**Regla de Negocio:**
Si `dominio` in `DOMINIOS_B2B_ACTIVOS`:
1.  Marcar `is_potential_corporate = true`.
2.  Mostrar modal: *"¬°Buenas noticias! Tu empresa [Nombre] tiene convenio. Reg√≠strate con este correo para obtener 15% OFF."*
3.  Esto convierte usuarios org√°nicos B2C en usuarios Corporate+ de alto valor y retenci√≥n.

---

## Navegaci√≥n

| Elemento | Enlace |
|----------|--------|
| ‚¨ÜÔ∏è Padre | [[Proyecto OnlyCarNLD/Datos/1.2.3 cliente_b2c_perfil]] |
| ‚û°Ô∏è Siguiente | [[Proyecto OnlyCarNLD/Datos/1.2.3.2 solicitud_servicio]] |
| üîó Auth Tech | [[Proyecto OnlyCarNLD/Datos/5.6. autenticacion]] |
