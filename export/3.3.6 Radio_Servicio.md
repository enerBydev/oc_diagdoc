---
id: 3.3.6
title: Radio de Servicio
parent: '3.3'
breadcrumb: 0 ‚Üí 3.0 ‚Üí 3.3 ‚Üí 3.3.6
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-05 12:40
domain:
- negocio
- geofencing
- radio
actors:
- cliente
- admin
summary: Geofencing y cobertura por ciudad.
content_hash: 6722821385bfc15b
---

# 3.3.6 Radio de Servicio

> Cobertura geogr√°fica y geofencing.

---

## 1. Cobertura Actual

| Ciudad | Radio | Estado |
|--------|-------|--------|
| Nuevo Laredo | 15 km | ‚úÖ Activo |
| Laredo TX | Bajo demanda | ‚ö†Ô∏è Beta |

---

## 2. Centro de Operaciones

- **Latitud:** 27.4863
- **Longitud:** -99.5075
- **Radio m√°ximo:** 15 km

---

## 3. L√≥gica de Validaci√≥n Geofencing

```typescript
// composables/useGeofencing.ts
import { haversineDistance } from '@/utils/geo';

interface ServiceArea {
  center: { lat: number; lng: number };
  radiusKm: number;
}

const SERVICE_AREAS: Record<string, ServiceArea> = {
  nuevo_laredo: {
    center: { lat: 27.4863, lng: -99.5075 },
    radiusKm: 15
  }
};

export const isInServiceArea = (
  lat: number, 
  lng: number, 
  city = 'nuevo_laredo'
): boolean => {
  const area = SERVICE_AREAS[city];
  if (!area) return false;
  
  const distance = haversineDistance(area.center, { lat, lng });
  return distance <= area.radiusKm;
};

export const getDistanceToCenter = (lat: number, lng: number): number => {
  const area = SERVICE_AREAS['nuevo_laredo'];
  return haversineDistance(area.center, { lat, lng });
};

// F√≥rmula Haversine (en utils/geo.ts)
export const haversineDistance = (
  a: { lat: number; lng: number },
  b: { lat: number; lng: number }
): number => {
  const R = 6371; // Radio de la Tierra en km
  const dLat = toRad(b.lat - a.lat);
  const dLon = toRad(b.lng - a.lng);
  
  const h = Math.sin(dLat / 2) ** 2 +
            Math.cos(toRad(a.lat)) * Math.cos(toRad(b.lat)) *
            Math.sin(dLon / 2) ** 2;
  
  return 2 * R * Math.asin(Math.sqrt(h));
};
```

---

## 4. Uso en Validaci√≥n de Cita

```typescript
// Al crear cita, validar ubicaci√≥n
const validateCitaLocation = async (direccion: Direccion) => {
  const { lat, lng } = await geocode(direccion);
  
  if (!isInServiceArea(lat, lng)) {
    throw new Error('FUERA_DE_COBERTURA');
  }
  
  return { lat, lng, distancia: getDistanceToCenter(lat, lng) };
};
```

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre | [[Proyecto OnlyCarNLD/Datos/3.3. reglas_negocio]] |
|----------|-------------------------|
| ‚¨ÖÔ∏è Anterior | [[Proyecto OnlyCarNLD/Datos/3.3.5 Horarios_Disponibilidad]] |
| ‚û°Ô∏è Siguiente | [[Proyecto OnlyCarNLD/Datos/3.3.7 Feature_Flags]] |
| üîó Relacionado | [[Proyecto OnlyCarNLD/Datos/5.8. geolocalizacion]] |

---

