---
id: 7.2.2
title: Capa de Aplicación
parent: '7.2'
breadcrumb: 0 → 7.0 → 7.2 → 7.2.2
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-21 12:36
domain:
- application
- use-cases
- dto
summary: Use Cases y DTOs que orquestan la lógica de negocio.
content_hash: b139d4ec463d4b29
---

# 7.2.2 Capa de Aplicación

> Orquesta los casos de uso llamando al dominio y a la infraestructura.

---

## Use Cases

```typescript
// application/use-cases/citas/AgendarCitaUseCase.ts
export class AgendarCitaUseCase implements IAgendarCita {
  constructor(
    private citaRepo: ICitaRepository,
    private disponibilidadService: DisponibilidadService,
    private pricingService: PricingService
  ) {}
  
  async execute(input: AgendarCitaInput): Promise<AgendarCitaOutput> {
    // 1. Validar disponibilidad
    const disponible = await this.disponibilidadService
      .verificarDisponibilidad(input.fechaHora);
    
    if (!disponible) {
      throw new ApplicationError('SIN_DISPONIBILIDAD');
    }
    
    // 2. Calcular precio
    const precio = this.pricingService.calcular(input.servicioId, input);
    
    // 3. Crear entidad
    const cita = new Cita(
      generateId(),
      input.clienteId,
      input.servicioId,
      input.ubicacion,
      input.fechaHora
    );
    
    // 4. Persistir
    await this.citaRepo.save(cita);
    
    // 5. Retornar DTO
    return {
      success: true,
      cita: CitaDTO.fromEntity(cita),
      precio
    };
  }
}
```

---

## DTOs (Data Transfer Objects)

```typescript
// application/dto/CitaDTO.ts
export class CitaDTO {
  id: string;
  clienteId: string;
  servicioId: string;
  estado: string;
  fechaHora: string;
  ubicacion: { lat: number; lng: number };
  
  static fromEntity(cita: Cita): CitaDTO {
    return {
      id: cita.id,
      clienteId: cita.clienteId,
      servicioId: cita.servicioId,
      estado: cita.estado,
      fechaHora: cita.fechaHora.toISOString(),
      ubicacion: cita.ubicacion
    };
  }
}
```

---

## Navegación

| ⬆️ Padre | [[Proyecto OnlyCarNLD/Datos/7.2 Clean_Architecture_DDD]] |
|----------|-------------------------------|
| ⬅️ Anterior | [[Proyecto OnlyCarNLD/Datos/7.2.1 Domain_Layer]] |
| ➡️ Siguiente | [[Proyecto OnlyCarNLD/Datos/7.2.3 Infrastructure_Layer]] |

---
