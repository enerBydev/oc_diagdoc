---
id: 3.1.12.4.2
title: Integración IMSS
parent: 3.1.12.4
breadcrumb: 0 → 3.0 → 3.1 → 3.1.12 → 3.1.12.4 → 3.1.12.4.2
type: hoja
status: futuro
last_updated: 2026-01-29 15:31
file_create: 2026-01-24 11:38
domain:
- imss
- declaracion
- patronal
- seguridad_social
actors:
- admin
- sistema
summary: Proceso de declaración patronal ante IMSS para registrar las semanas cotizadas
  del operador.
content_hash: d1a38e6c7cc99d19
---

# 3.1.12.4.2 Integración IMSS

> [!NOTE]
> **MÓDULO FUTURO** — Proceso de integración con el Instituto Mexicano del Seguro Social.

---

## Modelo de Integración

OnlyCar actuaría como **patrón** ante el IMSS, reportando las semanas cotizadas de cada operador de forma mensual.

> [!CAUTION]
> **Implicaciones Legales:**
> Este modelo implica una relación laboral formal. Se requiere asesoría legal especializada antes de implementar.

---

## Flujo de Declaración

```mermaid
sequenceDiagram
    participant S as Sistema OnlyCar
    participant A as Admin
    participant IMSS as IMSS (API/Portal)
    
    S->>S: Calcular semanas del mes
    S->>A: Generar reporte mensual
    A->>IMSS: Enviar declaración
    IMSS-->>A: Confirmación
    A->>S: Registrar comprobante
```

---

## Datos Requeridos por Operador

| Dato | Descripción | Fuente |
|------|-------------|--------|
| CURP | Clave Única de Registro | Registro operador |
| NSS | Número de Seguro Social | Captura o alta |
| Semanas | Semanas cotizadas del mes | Sistema |
| SDI | Salario Diario Integrado | Calculado |

---

## Manejo de Errores

### Estructura de Respuesta IMSS

```typescript
interface RespuestaIMSS {
  exitoso: boolean;
  codigo: string;      // E001, E002, E003, S001
  mensaje: string;
  reintentable: boolean;
}
```

### Códigos de Error Comunes

| Código | Causa | Acción del Sistema | Notificación |
|--------|-------|-------------------|--------------|
| `E001` | NSS inválido o inexistente | Marcar operador para corrección | Admin + Operador |
| `E002` | SDI fuera de límites IMSS | Recalcular con topes legales | Solo Admin |
| `E003` | Declaración duplicada | Omitir y registrar en log | Solo Log |
| `E004` | Servicio IMSS no disponible | Reintentar en 1 hora | Solo Sistema |
| `S001` | Éxito | Registrar comprobante | Admin |

### Flujo de Reintento

```mermaid
flowchart TD
    A[Enviar Declaración] --> B{¿Respuesta?}
    B -->|E001/E002| C[Notificar Admin]
    B -->|E003| D[Ignorar + Log]
    B -->|E004| E[Encolar reintento]
    B -->|S001| F[Registrar éxito]
    C --> G[Corrección Manual]
    G --> A
    E --> H{¿Intento < 3?}
    H -->|Sí| I[Esperar 1h]
    I --> A
    H -->|No| J[Escalar a Admin]
```

### Tabla: `imss_declaraciones_log`

| Columna | Tipo | Descripción |
|---------|------|-------------|
| `id` | UUID | PK |
| `operador_id` | UUID | FK operadores |
| `mes` | Int | Mes de declaración (1-12) |
| `año` | Int | Año de declaración |
| `codigo_respuesta` | String | E001, S001, etc. |
| `intentos` | Int | Número de intentos |
| `exitoso` | Boolean | true si S001 |
| `timestamp` | DateTime | Fecha del último intento |

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/3.1.12.4 semanas_cotizadas]]           |
| -------------------- | ---------------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/3.1.12.4.1 registro_dias]]             |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/3.1.12.4.3 beneficios_gubernamentales]]|

---
