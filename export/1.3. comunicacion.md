---
id: '1.3'
title: Sistema de ComunicaciÃ³n
parent: '1.0'
breadcrumb: 0 â†’ 1.0 â†’ 1.3
type: padre
status: activo
domain: comunicacion
summary: Sistema de mensajerÃ­a bidireccional estilo Messenger con canales admin-cliente
  y operador-cliente, CARDs interactivos, tiempo real y notificaciones.
version: 1.3
last_updated: 2026-01-29 15:32
file_create: 2025-12-23 10:56
children_count: 14
descendants_count: 86
actors:
- admin
- cliente
- operador
dependencies:
- supabase_realtime
- cloudflare_r2
- web_push
affects:
- 1.4.X calificacion
- 2.X.X servicios
content_hash: df737334ae1ac4db
---

# 1.3 Sistema de ComunicaciÃ³n

Sistema de mensajerÃ­a bidireccional inspirado en Messenger de Meta/Facebook.

> [!IMPORTANT]
> **Este mÃ³dulo documenta el chat INTERNO para usuarios registrados.**
> Para atenciÃ³n a **visitantes anÃ³nimos** (landing, pre-registro), ver:
> â†’ [[Proyecto OnlyCarNLD/Datos/5.9 soporte_externo|5.9 Soporte Externo]] (Tawk.to + Chatwoot)

---

## Alcance de este MÃ³dulo

| Tipo de Usuario | Canal | MÃ³dulo |
|-----------------|-------|--------|
| **Visitante web** | Tawk.to (live chat) | [[Proyecto OnlyCarNLD/Datos/5.9 soporte_externo]] |
| **Cliente registrado** | Chat interno | **1.3** (este mÃ³dulo) |
| **Operador** | Chat interno | **1.3** (este mÃ³dulo) |
| **Admin** | Chat interno | **1.3** (este mÃ³dulo) |

---

## Arquitectura de Canales

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SISTEMA DE CHAT ONLYCARNLD                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚   CANAL: ADMIN-CLIENTE    â”‚   â”‚ CANAL: OPERADOR-CLIENTE   â”‚ â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚   â”‚                           â”‚   â”‚                           â”‚ â”‚
â”‚   â”‚  ğŸ“‹ Negocios              â”‚   â”‚  ğŸš— Servicio              â”‚ â”‚
â”‚   â”‚  ğŸ“ Contratos             â”‚   â”‚  ğŸ“¸ Fotos antes/despuÃ©s   â”‚ â”‚
â”‚   â”‚  ğŸ”„ Renovaciones          â”‚   â”‚  ğŸ’¬ ComunicaciÃ³n rÃ¡pida   â”‚ â”‚
â”‚   â”‚  ğŸ’° Acuerdos comerciales  â”‚   â”‚  ğŸ“ UbicaciÃ³n/Llegada     â”‚ â”‚
â”‚   â”‚  ğŸ“Š Propuestas B2B        â”‚   â”‚  âœ… Confirmaciones        â”‚ â”‚
â”‚   â”‚                           â”‚   â”‚                           â”‚ â”‚
â”‚   â”‚  [B2B + B2C]              â”‚   â”‚  [Solo servicio activo]   â”‚ â”‚
â”‚   â”‚                           â”‚   â”‚                           â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CaracterÃ­sticas Estilo Messenger

| CaracterÃ­stica | DescripciÃ³n |
|----------------|-------------|
| **Lista de conversaciones** | Preview del Ãºltimo mensaje + timestamp |
| **Indicador de leÃ­do** | âœ“ Enviado, âœ“âœ“ Entregado, âœ“âœ“ LeÃ­do (azul) |
| **Typing indicator** | "Escribiendo..." en tiempo real |
| **Mensajes en tiempo real** | Supabase Realtime / WebSockets |
| **CARDs interactivos** | Servicios, pagos, contratos |
| **Multimedia** | Fotos, PDFs, enlaces |
| **BÃºsqueda** | Buscar en historial de conversaciones |
| **Notificaciones** | Push, email, badge en app |
| **Responsive** | MÃ³vil y desktop |

---

## Interfaz de Usuario

### Vista Lista de Chats

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¬ MENSAJES                                      ğŸ”           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”µ Empresa XYZ (Admin)                        14:30     â”‚   â”‚
â”‚  â”‚    Perfecto, enviamos el contrato...                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âšª Carlos Limpieza (Operador)                 Ayer      â”‚   â”‚
â”‚  â”‚    âœ… Servicio completado. Ver fotos...                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âšª MarÃ­a GarcÃ­a (Cliente B2C)                 Hace 3d   â”‚   â”‚
â”‚  â”‚    Gracias, quedÃ³ excelente ğŸ™Œ                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Vista ConversaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Empresa XYZ                                        ğŸ“ â‹®    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                              â”‚ Hola, nos interesa          â”‚   â”‚
â”‚                              â”‚ contratar sus servicios     â”‚   â”‚
â”‚                              â”‚ para nuestra flotilla       â”‚   â”‚
â”‚                              â”‚                      14:25  â”‚   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Â¡Excelente! Le comparto     â”‚                               â”‚
â”‚  â”‚ nuestra propuesta...        â”‚                               â”‚
â”‚  â”‚ 14:28 âœ“âœ“                    â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“„ CARD: Propuesta Express Flotilla                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚  15 vehÃ­culos â€¢ $224/u â€¢ 25% OFF                        â”‚   â”‚
â”‚  â”‚  [ Ver propuesta completa ]                             â”‚   â”‚
â”‚  â”‚                                                  14:28  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Escribiendo... â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“  Aa  Escribe un mensaje...                        â¤        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## TecnologÃ­a

| Componente | TecnologÃ­a |
|------------|------------|
| **Tiempo real** | Supabase Realtime |
| **Base de datos** | PostgreSQL (mensajes, conversaciones) |
| **Archivos** | Cloudflare R2 (fotos, PDFs) |
| **Notificaciones push** | Web Push API / Firebase |
| **Estado online** | Supabase Presence |

---

## Estructura de Hijos

| ID                                            | Nombre           | DescripciÃ³n                | Nietos | Estado |
| --------------------------------------------- | ---------------- | -------------------------- | ------ | ------ |
| [[Proyecto OnlyCarNLD/Datos/1.3.1 chat_arquitectura\|1.3.1]]            | Arquitectura     | Modelo de datos y realtime | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.2 chat_admin_cliente\|1.3.2]]           | Admin-Cliente    | Canal comercial            | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.3 chat_operador_cliente\|1.3.3]]        | Operador-Cliente | Canal de servicio          | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.4 tipos_mensajes\|1.3.4]]               | Tipos Mensajes   | CatÃ¡logo de tipos          | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.5 notificaciones\|1.3.5]]               | Notificaciones   | Push y email               | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.6 chat_admin_operador\|1.3.6]]          | Admin-Operador   | GestiÃ³n y asignaciÃ³n       | 15+    | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.7 hub_chat_admin\|1.3.7]]               | Hub Admin        | Centro de mensajes admin   | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.8 chat_cliente_b2c\|1.3.8]]             | Cliente B2C      | Vista cliente individual   | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.9 chat_cliente_corporate\|1.3.9]]       | Cliente Corp+    | Vista Corporate+           | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.10 chat_cliente_b2b\|1.3.10]]           | Cliente B2B      | Vista empresa              | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.11 chat_operador_vista\|1.3.11]]        | Vista Operador   | UI del operador            | 0      | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.12 upload_multimedia\|1.3.12]]          | Upload Media     | Sistema universal          | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.13 recordatorios_amistosos\|1.3.13]]    | Recordatorios    | Recordatorios amistosos    | 0 | âœ…      |
| [[Proyecto OnlyCarNLD/Datos/1.3.14 archivado_chats\|1.3.14]]            | Archivado Chats  | RetenciÃ³n y cumplimiento   | 0 | âœ…      |

---

## NavegaciÃ³n

| â¬†ï¸ Padre       | [[Proyecto OnlyCarNLD/Datos/1.0. identidad_y_contexto]]              |
| -------------- | ------------------------------------------ |
| â¬…ï¸ Anterior    | [[Proyecto OnlyCarNLD/Datos/1.2. user_personas]]                     |
| â¡ï¸ Siguiente   | [[Proyecto OnlyCarNLD/Datos/1.4. sistema_calificacion_feedback]]     |

---
