---
id: 2.19.3
title: Failover DNS
parent: '2.19'
breadcrumb: 0 ‚Üí 2.0 ‚Üí 2.19 ‚Üí 2.19.3
type: infraestructura
children_count: 0
descendants_count: 0
status: activo
domain:
- dns
- failover
- cloudflare
- alta-disponibilidad
actors:
- devops
summary: 'Estrategia de Failover DNS autom√°tico: Health checks, traffic steering y
  p√°gina de mantenimiento est√°tica.'
last_updated: 2026-01-29 15:31
file_create: 2026-01-23 03:10
content_hash: 6f98cb3d896a1556
---

# 2.19.3 Failover DNS

> Cuando el servidor primario cae, el tr√°fico debe fluir a un lugar seguro.

---

## Arquitectura de Failover

Utilizamos **Cloudflare Load Balancing** para monitorear la salud del origen.

```mermaid
flowchart TD
    User --> CF{Cloudflare Edge}
    
    CF --> |Health Check OK| Origin[üü¢ Prod Server]
    CF --> |Health Check FAIL| Failover{Failover Logic}
    
    Failover --> |Option A| Replica[üü° Read-Only Replica]
    Failover --> |Option B| Maintenance[üî¥ Static Maintenance Page]
```

---

## Configuraci√≥n de Health Checks

Cloudflare pingeando al origen cada 60s.

- **Path:** `/api/_health`
- **Expected Code:** `200`
- **Timeout:** `5s`
- **Retries:** `2`

Si falla 2 veces consecutivas ‚Üí **Marcar como Unhealthy**.

---

## P√°gina de Mantenimiento (Netlify)

En caso de fallo catastr√≥fico total (ej. ca√≠da de regi√≥n AWS), redirigimos a una p√°gina est√°tica hosteada en Netlify/Vercel (fuera de nuestra infra principal).

**Contenido:**
- "Estamos en mantenimiento"
- Estado del incidente (iframe de status page)
- Link a soporte WhatsApp

**Switch Manual:**
```bash
./ops/emergency/switch-dns.sh maintenance
```

---

## Recuperaci√≥n (Failback)

Automatizado. Cuando `/api/_health` retorna 200 consistentemente por 5 minutos, Cloudflare re-enruta el tr√°fico al origen primario.

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre             | [[Proyecto OnlyCarNLD/Datos/2.19. Disaster_Recovery_Tech]] |
| -------------------- | -------------------------------- |
| ‚¨ÖÔ∏è Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.19.2 Restore_Procedures]]    |
| ‚û°Ô∏è Hermano siguiente | *(√öltimo hijo de 2.19)*          |

---
