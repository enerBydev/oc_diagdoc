---
id: 5.8.6.5.7
title: Privacidad GDPR
parent: 5.8.6.5
breadcrumb: 0 ‚Üí 5.0 ‚Üí 5.8 ‚Üí 5.8.6 ‚Üí 5.8.6.5 ‚Üí 5.8.6.5.7
type: privacidad
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-01 18:10
domain:
- gdpr
- lfpdppp
- privacidad
summary: Cumplimiento GDPR/LFPDPPP.
content_hash: c56938b8d3a52d2d
---

# 5.8.6.5.7 Privacidad y GDPR

Cumplimiento de regulaciones de privacidad para datos de ubicaci√≥n.

---

## Marco Legal Aplicable

| Regulaci√≥n | Aplica | Raz√≥n |
|------------|--------|-------|
| **LFPDPPP** (M√©xico) | ‚úÖ | Datos personales de mexicanos |
| **GDPR** (UE) | ‚ö†Ô∏è Potencial | Si hay clientes europeos |
| **CCPA** (California) | ‚ö†Ô∏è Potencial | Si hay clientes de California |

---

## Clasificaci√≥n de Datos

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CLASIFICACI√ìN DE DATOS DE UBICACI√ìN                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  DATOS SENSIBLES (requieren consentimiento expl√≠cito):          ‚îÇ
‚îÇ  ‚Ä¢ Ubicaci√≥n GPS del operador                                   ‚îÇ
‚îÇ  ‚Ä¢ Historial de recorridos                                      ‚îÇ
‚îÇ  ‚Ä¢ Patrones de movimiento                                       ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  DATOS DERIVADOS (menos sensibles pero regulados):              ‚îÇ
‚îÇ  ‚Ä¢ Tiempo de llegada                                            ‚îÇ
‚îÇ  ‚Ä¢ Distancia recorrida                                          ‚îÇ
‚îÇ  ‚Ä¢ Zonas frecuentadas                                           ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  DATOS ANONIMIZADOS (no regulados):                             ‚îÇ
‚îÇ  ‚Ä¢ Estad√≠sticas agregadas por zona                              ‚îÇ
‚îÇ  ‚Ä¢ Promedios sin identificaci√≥n personal                        ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Principios de Privacidad

### 1. Minimizaci√≥n de Datos

```typescript
// Solo recolectar lo necesario
interface UbicacionMinima {
  lat: number;          // Necesario
  lng: number;          // Necesario
  accuracy: number;     // Necesario para validaci√≥n
  // NO recolectar:
  // - altitud (innecesario)
  // - nombre del lugar (innecesario)
  // - wifi cercanos (invasivo)
}
```

### 2. Limitaci√≥n de Prop√≥sito

| Prop√≥sito Leg√≠timo | Descripci√≥n |
|-------------------|-------------|
| Prestaci√≥n del servicio | Mostrar ubicaci√≥n al cliente |
| Cumplimiento de contrato | Evidencia para disputas |
| Mejora del servicio | Analytics agregados |
| ‚ùå Publicidad | NO permitido |
| ‚ùå Venta a terceros | NO permitido |

### 3. Limitaci√≥n de Almacenamiento

```sql
-- Ya implementado en pol√≠tica de retenci√≥n
-- Ubicaciones intermedias: 30 d√≠as
-- Llegadas: 1 a√±o
-- Archivos: 3 a√±os
-- Despu√©s: eliminaci√≥n permanente
```

---

## Consentimiento del Operador

### Aviso de Privacidad (Onboarding)

```markdown
## üìç Uso de tu Ubicaci√≥n

Durante los servicios, OnlyCar recopilar√° tu ubicaci√≥n GPS para:

‚úÖ Mostrar tu posici√≥n al cliente en tiempo real
‚úÖ Confirmar autom√°ticamente tu llegada
‚úÖ Generar evidencia en caso de disputas
‚úÖ Mejorar la eficiencia del servicio

**Tus datos de ubicaci√≥n:**
- Solo se recopilan durante servicios activos
- Se comparten solo con el cliente asignado
- Se eliminan autom√°ticamente despu√©s de 30 d√≠as
- Puedes solicitar copia o eliminaci√≥n en cualquier momento

[ Acepto y Continuar ]
```

### Registro de Consentimiento

```sql
CREATE TABLE consentimientos_ubicacion (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id),
  version_aviso VARCHAR(20) NOT NULL,
  aceptado BOOLEAN NOT NULL,
  ip_address INET,
  user_agent TEXT,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Verificar consentimiento antes de tracking
CREATE OR REPLACE FUNCTION verificar_consentimiento(p_user_id UUID)
RETURNS BOOLEAN AS $$
BEGIN
  RETURN EXISTS (
    SELECT 1 FROM consentimientos_ubicacion
    WHERE user_id = p_user_id
    AND aceptado = true
    AND version_aviso = 'v1.0'
  );
END;
$$ LANGUAGE plpgsql;
```

---

## Derechos del Usuario (ARCO)

| Derecho | Implementaci√≥n |
|---------|----------------|
| **Acceso** | Exportar JSON de ubicaciones |
| **Rectificaci√≥n** | N/A (datos GPS no editables) |
| **Cancelaci√≥n** | Solicitar eliminaci√≥n anticipada |
| **Oposici√≥n** | Revocar consentimiento |

### Exportar Datos (Derecho de Portabilidad)

```typescript
// server/api/gdpr/export.post.ts
export default defineEventHandler(async (event) => {
  const userId = event.context.user?.id;
  
  // Obtener todas las ubicaciones del usuario
  const { data } = await supabase
    .from('ubicaciones_servicio')
    .select('*')
    .eq('operador_id', userId);
  
  // Formato GDPR compliant
  const exportData = {
    usuario_id: userId,
    fecha_exportacion: new Date().toISOString(),
    ubicaciones: data,
    politica_aplicada: 'Retenci√≥n 30 d√≠as, llegadas 1 a√±o'
  };
  
  // Log de auditor√≠a
  await logAuditAction('GDPR_EXPORT', userId);
  
  return exportData;
});
```

### Solicitar Eliminaci√≥n

```typescript
// server/api/gdpr/delete.post.ts
export default defineEventHandler(async (event) => {
  const userId = event.context.user?.id;
  const body = await readBody(event);
  
  // Verificar que no hay disputas activas
  const { data: disputas } = await supabase
    .from('servicios')
    .select('id')
    .eq('operador_id', userId)
    .eq('tiene_disputa', true);
  
  if (disputas?.length) {
    throw createError({
      statusCode: 409,
      message: `Tienes ${disputas.length} servicio(s) con disputa activa. 
                Los datos no pueden eliminarse hasta resolver las disputas.`
    });
  }
  
  // Eliminar ubicaciones
  const { count } = await supabase
    .from('ubicaciones_servicio')
    .delete()
    .eq('operador_id', userId)
    .select('*', { count: 'exact', head: true });
  
  // Revocar consentimiento
  await supabase
    .from('consentimientos_ubicacion')
    .update({ aceptado: false })
    .eq('user_id', userId);
  
  // Log
  await logAuditAction('GDPR_DELETE', userId, { registros_eliminados: count });
  
  return { success: true, registros_eliminados: count };
});
```

---

## Anonimizaci√≥n para Analytics

```sql
-- Vista anonimizada para analytics p√∫blicos
CREATE VIEW v_analytics_anonimizado AS
SELECT
  DATE_TRUNC('day', created_at) as fecha,
  -- Truncar coordenadas a 2 decimales (~1km precisi√≥n)
  ROUND(lat::numeric, 2) as lat_zona,
  ROUND(lng::numeric, 2) as lng_zona,
  -- Promedios sin identificaci√≥n
  AVG(accuracy) as precision_promedio,
  COUNT(*) as total_registros
FROM ubicaciones_servicio
GROUP BY 
  DATE_TRUNC('day', created_at),
  ROUND(lat::numeric, 2),
  ROUND(lng::numeric, 2);
  
-- No se puede vincular a operadores espec√≠ficos
```

---

## Auditor√≠a de Accesos

```sql
CREATE TABLE audit_ubicaciones (
  id SERIAL PRIMARY KEY,
  user_id UUID,
  accion VARCHAR(50) NOT NULL,
  servicio_id UUID,
  detalle JSONB,
  ip_address INET,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Trigger para loggear accesos a ubicaciones
CREATE OR REPLACE FUNCTION log_acceso_ubicacion()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO audit_ubicaciones (user_id, accion, servicio_id)
  VALUES (
    current_setting('app.current_user_id', true)::UUID,
    'VIEW_UBICACION',
    NEW.servicio_id
  );
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

---

## Checklist GDPR

- [x] Consentimiento expl√≠cito antes de recolectar
- [x] Aviso de privacidad claro y accesible
- [x] Minimizaci√≥n de datos
- [x] Pol√≠tica de retenci√≥n definida
- [x] Derecho de acceso implementado
- [x] Derecho de eliminaci√≥n implementado
- [x] Anonimizaci√≥n para analytics
- [x] Auditor√≠a de accesos
- [ ] DPO designado (si >10K usuarios)
- [ ] Evaluaci√≥n de impacto (PIA)

---

‚Üí Ver estimaciones de storage: [[Proyecto OnlyCarNLD/Datos/5.8.6.5.8 storage_estimaciones]]

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre             | [[Proyecto OnlyCarNLD/Datos/5.8.6.5 historial_ubicaciones]]            |
| -------------------- | ---------------------- |
| ‚¨ÖÔ∏è Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/5.8.6.5.6 reconstruccion_ruta]]              |
| ‚û°Ô∏è Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/5.8.6.5.8 storage_estimaciones]]              |

---
