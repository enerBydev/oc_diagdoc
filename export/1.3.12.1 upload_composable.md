---
id: 1.3.12.1
title: Upload Composable
parent: 1.3.12
breadcrumb: 0 → 1.0 → 1.3 → 1.3.12 → 1.3.12.1
type: hoja
status: activo
domain: comunicacion
summary: API y lógica reutilizable de subida de archivos con estados UploadItem y
  configuración.
version: 1.0
last_updated: 2026-01-29 15:32
file_create: 2025-12-26 11:59
actors:
- sistema
dependencies:
- cloudflare_r2
affects:
- 1.3.12 upload_multimedia
content_hash: 019d7e0a1c515b7d
---

# 1.3.12.1 Upload Composable

Lógica reutilizable de subida de archivos.

---

## API

```typescript
const {
  items,           // UploadItem[]
  isUploading,     // boolean
  uploadProgress,  // number (0-100)
  isValidCount,    // boolean
  addFiles,        // (files: FileList) => void
  uploadAll,       // () => Promise<void>
  retryItem,       // (id: string) => Promise<void>
  removeItem,      // (id: string) => void
  clear            // () => void
} = useMediaUpload(config);
```

---

## Estados UploadItem

| Estado | Descripción | UI |
|--------|-------------|-----|
| `pending` | Seleccionado, no iniciado | ⏳ Gris |
| `processing` | Comprimiendo | ↻ 10-30% |
| `uploading` | Subiendo a R2 | ↑ 30-90% |
| `completed` | Listo | ✓ Verde |
| `error` | Falló | ❌ Rojo |

---

## Configuración

```typescript
interface UploadConfig {
  maxFiles: number;        // Default: 10
  minFiles: number;        // Default: 1
  maxSizeMB: number;       // Default: 10
  allowedTypes: string[];  // ['image/jpeg', 'image/png', ...]
  context: string;         // 'operador_antes', 'chat_attachment', etc.
  entityId?: string;       // ID del servicio, conversación, etc.
}
```

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/1.3.12 upload_multimedia]]  |
| -------------------- | ----------------------------- |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/1.3.12.2 upload_ui]]        |

---
