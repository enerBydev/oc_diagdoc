---
id: 5.8.3.6
title: Performance
parent: 5.8.3
breadcrumb: 0 → 5.0 → 5.8 → 5.8.3 → 5.8.3.6
type: optimizacion
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-01 18:08
domain:
- performance
- lazy
- mapas
summary: Optimización de rendimiento mapas.
content_hash: f4915919bbb4f3f2
---

# 5.8.3.6 Performance

Optimización de rendimiento del mapa.

---

## Métricas Objetivo

| Métrica | Objetivo | Actual |
|---------|----------|--------|
| First Paint | < 500ms | ~300ms |
| Time to Interactive | < 1s | ~800ms |
| Tiles Load | < 2s | ~1.5s |
| Update Latency | < 100ms | ~50ms |

---

## Optimizaciones

### 1. Lazy Loading de Leaflet

```typescript
// Solo cargar cuando es visible
const loadLeaflet = async () => {
  const L = await import('leaflet');
  return L.default;
};
```

### 2. Precargar Tiles del Área

```typescript
// Precargar tiles de Nuevo Laredo
const preloadArea = async (map: L.Map) => {
  const bounds = map.getBounds();
  const zoom = map.getZoom();
  
  // Forzar carga de tiles visibles
  map.invalidateSize();
};
```

### 3. Limitar Updates de Marker

```typescript
// Throttle de animaciones
let lastUpdate = 0;
const MIN_UPDATE_INTERVAL = 100; // ms

const updateMarker = (lat: number, lng: number) => {
  const now = Date.now();
  if (now - lastUpdate < MIN_UPDATE_INTERVAL) return;
  lastUpdate = now;
  
  marker.setLatLng([lat, lng]);
};
```

### 4. Recyclar Markers

```typescript
// No crear/destruir markers innecesariamente
if (marker) {
  marker.setLatLng([lat, lng]);
} else {
  marker = L.marker([lat, lng]).addTo(map);
}
```

---

## Bundle Size

| Librería | Tamaño | Gzipped |
|----------|--------|---------|
| Leaflet | 140KB | 40KB |
| Tiles CSS | 8KB | 3KB |
| **Total** | 148KB | 43KB |

---

## Service Worker Cache

```typescript
// Cachear tiles para offline
self.addEventListener('fetch', (e) => {
  if (e.request.url.includes('tile.openstreetmap.org')) {
    e.respondWith(
      caches.match(e.request).then(r => r || fetch(e.request))
    );
  }
});
```

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/5.8.3 mapas_visualizacion]]            |
| -------------------- | ---------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/5.8.3.5 accessibility]]              |
