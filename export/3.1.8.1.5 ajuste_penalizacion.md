---
id: 3.1.8.1.5
title: Ajuste por Penalización
parent: 3.1.8.1
breadcrumb: 0 → 3.0 → 3.1 → 3.1.8 → 3.1.8.1 → 3.1.8.1.5
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2025-12-27 14:08
domain:
- penalizaciones
- deducciones
- infracciones
actors:
- admin
- operador
summary: 'Deducciones por incumplimientos.

  Cancelación -2%, queja -1%, retraso -0.5%. Mínimo 40%.'
content_hash: fbb4a199925c93d0
---

# 3.1.8.1.5 Ajuste por Penalización

Deducciones por incumplimientos.

---

## Penalizaciones

| Infracción | Penalización | Acumulativo |
|------------|--------------|-------------|
| Cancelación operador | -2% por evento | Sí |
| Queja confirmada | -1% por queja | Máx -3% |
| Retraso >30 min | -0.5% | Por servicio |
| Caja no liquidada | Bloqueo servicios | — |

---

## Límite de Penalización

```typescript
// Comisión mínima garantizada: 40%
const aplicarPenalizacion = (
  comisionBase: number,
  penalizaciones: Penalizacion[]
): number => {
  const totalPenalizacion = penalizaciones.reduce((s, p) => s + p.porcentaje, 0);
  const comisionConPenalizacion = comisionBase - totalPenalizacion;
  
  // Nunca menos del 40%
  return Math.max(comisionConPenalizacion, 40);
};
```

---

## UI: Penalizaciones del Mes

```
┌─────────────────────────────────────────────────────────────────┐
│  ⚠️ PENALIZACIONES - DICIEMBRE 2024                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Comisión base actual: 73% (Plata)                              │
│  Bonos activos: +3%                                             │
│                                                                 │
│  ─── DESCUENTOS ─────────────────────────────────────────────   │
│                                                                 │
│  ⛔ Cancelación (15/12)                            -2%          │
│     Motivo: No llegaste al servicio                             │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│  Comisión final: 73% + 3% - 2% = 74%                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Modelo de Datos

```sql
CREATE TABLE operador_penalizaciones (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  operador_id UUID REFERENCES operadores(id),
  
  tipo VARCHAR(50) NOT NULL, -- cancelacion, queja, retraso
  porcentaje DECIMAL(5,2) NOT NULL,
  motivo TEXT,
  servicio_id UUID REFERENCES citas(id),
  
  aplicado BOOLEAN DEFAULT false,
  periodo_inicio DATE,
  periodo_fin DATE,
  
  created_at TIMESTAMPTZ DEFAULT now()
);
```

---

## Navegación

| ⬆️ Padre            | [[Proyecto OnlyCarNLD/Datos/3.1.8.1 modelo_comision]]          |
| ------------------- | ------------------------------------ |
| ⬅️ Hermano anterior | [[Proyecto OnlyCarNLD/Datos/3.1.8.1.4 bonos_productividad]]    |

---
