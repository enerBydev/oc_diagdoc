---
id: 2.18.4
title: Coverage Reporting
parent: '2.18'
breadcrumb: 0 → 2.0 → 2.18 → 2.18.4
type: testing
children_count: 0
descendants_count: 0
status: activo
domain:
- testing
- coverage
- vitest
- istanbul
actors:
- desarrollador
- qa
summary: 'Reporte de cobertura de código: Configuración de Istanbul, umbrales mínimos
  y visualización en CI.'
last_updated: 2026-01-29 15:32
file_create: 2026-01-23 02:40
content_hash: c34b7289b379852b
---

# 2.18.4 Coverage Reporting

> "La cobertura del 100% es un mito, pero el 80% es una red de seguridad".

---

## Configuración de Cobertura

Usamos **Vitest** con provider **v8** (más rápido) o **istanbul** (más preciso).

```typescript
// vitest.config.ts
export default defineConfig({
  test: {
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'node_modules/',
        'test/',
        '**/*.d.ts',
        '**/*.config.ts'
      ],
      // Umbrales mínimos (fail build if below)
      thresholds: {
        lines: 80,
        functions: 80,
        branches: 70, // Ramas son más difíciles
        statements: 80
      }
    }
  }
})
```

---

## Ejecución

### Local

```bash
# Correr tests con cobertura y abrir reporte HTML
npm run test:coverage
open coverage/index.html
```

### En CI (GitHub Actions)

```yaml
- name: Run Tests with Coverage
  run: npm run test:coverage

- name: Upload Coverage Artifact
  uses: actions/upload-artifact@v3
  with:
    name: code-coverage
    path: coverage/
```

---

## Codecov Integration (Opcional)

Si se usa servicio externo:

```yaml
- name: Upload to Codecov
  uses: codecov/codecov-action@v3
  with:
    token: ${{ secrets.CODECOV_TOKEN }}
    files: ./coverage/coverage-final.json
```

---

## Interpretación de Métricas

| Métrica | Definición | Objetivo |
|---------|------------|----------|
| **Statement** | ¿Cada sentencia se ejecutó? | 80% |
| **Branch** | ¿Cada `if/else` se evaluó true y false? | 70% |
| **Function** | ¿Cada función fue llamada? | 80% |
| **Lines** | ¿Cada línea de código fue tocada? | 80% |

> **Nota:** Código de UI pura (componentes visuales) suele tener menor cobertura unitaria y delega a pruebas E2E o Visuales.

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.18. Testing_Infrastructure]] |
| -------------------- | -------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.18.3 Test_Fixtures_Mocks]]   |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.18.5 Visual_Regression]]     |

---
