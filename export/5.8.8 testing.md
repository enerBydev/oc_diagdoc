---
id: 5.8.8
title: Testing
parent: '5.8'
breadcrumb: 0 ‚Üí 5.0 ‚Üí 5.8 ‚Üí 5.8.8
type: modulo_padre
children_count: 3
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-01 18:10
domain:
- testing
- qa
- pruebas
summary: Pruebas de geolocalizaci√≥n.
content_hash: a525b3ae15731fc1
---

# 5.8.8 Testing

Estrategia de testing para el m√≥dulo de geolocalizaci√≥n.

---

## Pir√°mide de Tests

```
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ  E2E    ‚îÇ  üî∫ Pocos, lentos, costosos
                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ  Integration  ‚îÇ  üî∑ Algunos, moderados
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ      Unit Tests         ‚îÇ  üîπ Muchos, r√°pidos, baratos
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Cobertura por M√≥dulo

| M√≥dulo | Unit | Integration | E2E |
|--------|------|-------------|-----|
| Capacitor Geolocation | ‚úÖ | ‚ö†Ô∏è Mock | ‚ùå |
| Realtime Broadcast | ‚úÖ | ‚úÖ | ‚ö†Ô∏è |
| Mapas Leaflet | ‚ö†Ô∏è | ‚úÖ | ‚úÖ |
| Detecci√≥n Llegada | ‚úÖ | ‚úÖ | ‚úÖ |
| Edge Cases | ‚úÖ | ‚úÖ | ‚ö†Ô∏è |

---

## Herramientas

| Herramienta | Uso |
|-------------|-----|
| **Vitest** | Unit tests |
| **@vue/test-utils** | Componentes Vue |
| **MSW** | Mock Service Worker |
| **Playwright** | E2E browser |
| **Capacitor Mock** | Mock GPS nativo |

---

## Configuraci√≥n Vitest

```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config';
import vue from '@vitejs/plugin-vue';

export default defineConfig({
  plugins: [vue()],
  test: {
    environment: 'jsdom',
    globals: true,
    setupFiles: ['./tests/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      include: ['composables/**', 'utils/geo*.ts']
    },
    include: [
      'tests/unit/**/*.test.ts',
      'tests/integration/**/*.test.ts'
    ]
  },
  resolve: {
    alias: {
      '~': '/src',
      '@capacitor/geolocation': './tests/__mocks__/capacitor-geolocation.ts'
    }
  }
});
```

---

## Setup Global

```typescript
// tests/setup.ts
import { vi } from 'vitest';
import { config } from '@vue/test-utils';

// Mock Capacitor
vi.mock('@capacitor/geolocation', () => ({
  Geolocation: {
    getCurrentPosition: vi.fn(),
    watchPosition: vi.fn(),
    clearWatch: vi.fn(),
    checkPermissions: vi.fn(),
    requestPermissions: vi.fn()
  }
}));

// Mock Supabase
vi.mock('#supabase/client', () => ({
  useSupabaseClient: () => ({
    channel: vi.fn(() => ({
      on: vi.fn().mockReturnThis(),
      subscribe: vi.fn().mockReturnThis(),
      send: vi.fn()
    })),
    removeChannel: vi.fn()
  }),
  useSupabaseUser: () => ref({ id: 'test-user-id' })
}));

// Global mocks
config.global.stubs = {
  NuxtLink: true,
  ClientOnly: true
};
```

---

## Estructura de Hijos

| ID                                     | Nombre            | Descripci√≥n         | Estado |
| -------------------------------------- | ----------------- | ------------------- | ------ |
| [[Proyecto OnlyCarNLD/Datos/5.8.8.1 unit_tests\|5.8.8.1]]        | Unit Tests        | Pruebas unitarias   | ‚úÖ      |
| [[Proyecto OnlyCarNLD/Datos/5.8.8.2 integration_tests\|5.8.8.2]] | Integration Tests | Pruebas integraci√≥n | ‚úÖ      |
| [[Proyecto OnlyCarNLD/Datos/5.8.8.3 mock_location\|5.8.8.3]]     | Mock Location     | Mock GPS para tests | ‚úÖ      |

---

## Scripts npm

```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest run --reporter=verbose tests/unit",
    "test:integration": "vitest run tests/integration",
    "test:coverage": "vitest run --coverage",
    "test:e2e": "playwright test",
    "test:geo": "vitest run --reporter=verbose tests/unit/geo"
  }
}
```

---

‚Üí Ver unit tests: [[Proyecto OnlyCarNLD/Datos/5.8.8.1 unit_tests]]

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre             | [[Proyecto OnlyCarNLD/Datos/5.8. geolocalizacion]]            |
| -------------------- | ---------------------- |
| ‚¨ÖÔ∏è Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/5.8.7 edge_cases]]              |
| ‚û°Ô∏è Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/5.8.9 configuracion_remota]]              |
