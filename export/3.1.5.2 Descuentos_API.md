---
id: 3.1.5.2
title: Descuentos API
parent: 3.1.5
breadcrumb: 0 → 3.0 → 3.1 → 3.1.5 → 3.1.5.2
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-05 12:30
domain:
- api
- descuentos
actors:
- cliente
- admin
summary: Endpoints para validar y consultar descuentos disponibles.
content_hash: 7796fc6a15e8bdaf
---

# 3.1.5.2 Descuentos API

> Endpoints autenticados para gestión de descuentos.

---

## Endpoints

| Método | Ruta | Rol | Descripción |
|--------|------|-----|-------------|
| GET | `/api/descuentos/disponibles` | cliente | Descuentos aplicables al usuario |
| GET | `/api/descuentos/validar/:codigo` | cliente | Verificar código de descuento |

---

## Ejemplo: Validar Código

```typescript
export default defineEventHandler(async (event) => {
  const codigo = getRouterParam(event, 'codigo');
  const client = await serverSupabaseClient(event);
  
  const { data: descuento } = await client
    .from('descuentos')
    .select('codigo, nombre, porcentaje, tipo')
    .eq('codigo', codigo)
    .eq('activo', true)
    .single();
  
  if (!descuento) return { valid: false, message: 'Código no válido' };
  
  return { valid: true, descuento };
});
```

---

## Navegación

| ⬆️ Padre | [[Proyecto OnlyCarNLD/Datos/3.1.5 api_logica_negocio]] |
|----------|------------------------------|
| ⬅️ Anterior | [[Proyecto OnlyCarNLD/Datos/3.1.5.1 Catalogo_Publico]] |
| ➡️ Siguiente | [[Proyecto OnlyCarNLD/Datos/3.1.5.3 Empresa_API]] |

---
