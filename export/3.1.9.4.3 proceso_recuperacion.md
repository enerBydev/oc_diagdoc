---
id: 3.1.9.4.3
title: Proceso de RecuperaciÃ³n
parent: 3.1.9.4
breadcrumb: 0 â†’ 3.0 â†’ 3.1 â†’ 3.1.9 â†’ 3.1.9.4 â†’ 3.1.9.4.3
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2025-12-27 14:15
domain:
- recuperacion
- reactivacion
- deuda
actors:
- operador
summary: 'CÃ³mo el operador resuelve la deuda.

  Flujo de liquidaciÃ³n y reactivaciÃ³n automÃ¡tica.'
content_hash: e97ef10d1724c14b
---

# 3.1.9.4.3 Proceso de RecuperaciÃ³n

CÃ³mo el operador resuelve la deuda.

---

## Flujo de RecuperaciÃ³n

```
DEUDA DETECTADA
      â”‚
      â–¼
Operador notificado
      â”‚
      â–¼
Liquidar vÃ­a MercadoPago Checkout:
â”‚
â”œâ”€â”€ Si tiene efectivo â†’ Fondear cuenta MP primero
â””â”€â”€ Si tiene Saldo MP â†’ Pagar directo
      â”‚
      â–¼
Sistema verifica pago (Webhook)
      â”‚
      â–¼
Deuda saldada âœ…
      â”‚
      â–¼
Cuenta desbloqueada
Pago semanal liberado
```

```mermaid
flowchart TD
    A["âš ï¸ DEUDA DETECTADA"] --> B["ğŸ“± Operador notificado"]
    B --> C{"Â¿Tiene Saldo MP?"}
    
    C -->|SÃ­| D["ğŸ’³ Pagar vÃ­a Checkout"]
    C -->|No| E["ğŸª Fondear cuenta MP"]
    E --> D
    
    D --> F["ğŸ”” Webhook confirma"]
    F --> G["âœ… Deuda saldada"]
    G --> H["ğŸ”“ Cuenta desbloqueada"]
    H --> I["ğŸ’° Pago semanal liberado"]
```

---


## ReactivaciÃ³n AutomÃ¡tica

```typescript
// Trigger: Al verificarse depÃ³sito o pago
const reactivarCuenta = async (operadorId: string) => {
  // Verificar si ya no hay deuda
  const { count } = await supabase
    .from('deudas_caja')
    .select('*', { count: 'exact' })
    .eq('operador_id', operadorId)
    .eq('estado', 'activa');
  
  if (count === 0) {
    // Desbloquear cuenta
    await supabase
      .from('operadores')
      .update({ estado: 'activo' })
      .eq('id', operadorId);
    
    // Liberar pago retenido
    await supabase
      .from('pagos_operador')
      .update({ estado: 'pendiente', motivo: null })
      .eq('operador_id', operadorId)
      .eq('estado', 'retenido');
    
    // Notificar
    await notifyOperador(operadorId, {
      title: 'âœ… Â¡Cuenta reactivada!',
      body: 'Tu caja estÃ¡ al dÃ­a. Ya puedes recibir servicios.'
    });
  }
};
```

---

## UI: Cuenta Reactivada

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Â¡CUENTA REACTIVADA!                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Tu caja estÃ¡ al dÃ­a.                                           â”‚
â”‚                                                                 â”‚
â”‚  Ahora puedes:                                                  â”‚
â”‚  âœ… Aceptar nuevos servicios                                    â”‚
â”‚  âœ… Recibir tu pago semanal                                     â”‚
â”‚                                                                 â”‚
â”‚  Tu pago retenido de $2,188.92 serÃ¡ procesado                   â”‚
â”‚  en el prÃ³ximo corte (viernes 23:59).                           â”‚
â”‚                                                                 â”‚
â”‚  [ Ver servicios disponibles ]                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## NavegaciÃ³n

| â¬†ï¸ Padre            | [[Proyecto OnlyCarNLD/Datos/3.1.9.4 penalizaciones_caja]]   |
| ------------------- | --------------------------------- |
| â¬…ï¸ Hermano anterior | [[Proyecto OnlyCarNLD/Datos/3.1.9.4.2 bloqueo_servicios]]   |

---
