---
id: 2.7.3
title: CI/CD Pipeline
parent: '2.7'
breadcrumb: 0 → 2.0 → 2.7 → 2.7.3
type: especificacion
domain:
- ci-cd
- github-actions
- cloudflare
- automation
status: activo
last_updated: 2026-01-29 16:05
file_create: 2026-01-04 20:38
summary: 'Automatización de pruebas y despliegue continuo con GitHub Actions.

  Pipeline de validación en PR y deploy a Cloudflare Pages.'
content_hash: c655813db647c6ab
---

# 2.7.3 CI/CD Pipeline

> Automatización del ciclo de vida del software desde commit hasta producción.

---

## Workflow: Validación (`pr.yml`)

Se ejecuta en cada Pull Request hacia `main`.

1. **Checkout:** Obtener código.
2. **Setup:** Instalar Node.js y dependencias.
3. **Lint:** Verificar estilo de código (`npm run lint`).
4. **Typecheck:** Verificar tipos TypeScript (`nuxi typecheck`).
5. **Test:** Ejecutar pruebas unitarias (`npm run test`).
6. **Build:** Verificar que el proyecto compila (`npm run build`).

> Si algún paso falla, el PR se bloquea.

---

## Workflow: Deploy (`deploy.yml`)

Se ejecuta al hacer push (merge) a `main`.

```yaml
jobs:
  deploy:
    steps:
      - uses: actions/checkout@v4
      - name: Build
        run: npm run build
        env:
          NITRO_PRESET: cloudflare-pages
      
      - name: Publish to Cloudflare Pages
        uses: cloudflare/pages-action@v1
        with:
          apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          projectName: onlycar
          directory: .output/public
```

---

## Secretos en GitHub

Las variables sensibles definidas en [[Proyecto OnlyCarNLD/Datos/2.3. APIs_credentials]] deben cargarse en GitHub Secrets:

- `CLOUDFLARE_API_TOKEN`
- `SUPABASE_URL`
- `SUPABASE_ANON_KEY`
- `STRIPE_PUBLISHABLE_KEY` (pública, pero mejor inyectada)

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.7. Estandares_Desarrollo]]   |
| -------------------- | -------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.7.2 Git_Workflow]]           |

---
