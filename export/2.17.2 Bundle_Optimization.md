---
id: 2.17.2
title: Bundle Optimization
parent: '2.17'
breadcrumb: 0 → 2.0 → 2.17 → 2.17.2
type: optimizacion
children_count: 0
descendants_count: 0
status: activo
domain:
- performance
- bundle
- webpack
- vite
actors:
- desarrollador
- devops
summary: 'Optimización del bundle de JavaScript: Tree-shaking, Code Splitting, Lazy
  Loading y análisis de tamaño.'
last_updated: 2026-01-29 15:31
file_create: 2026-01-22 23:15
content_hash: fc595d885926bd6c
---

# 2.17.2 Bundle Optimization

> Cada kilobyte importa en redes móviles mexicanas.

---

## Presupuesto de Bundle

| Métrica | Límite | Actual |
|---------|--------|--------|
| **Initial JS** | < 150 KB gzip | Monitorear |
| **Total JS** | < 500 KB gzip | Monitorear |
| **Largest Chunk** | < 75 KB gzip | Monitorear |
| **CSS Total** | < 50 KB gzip | Monitorear |

---

## Técnicas de Optimización

### Flujo de Estrategia de Bundling

```mermaid
graph TD
    ENTRY[Entry Point (main.ts)] --> VENDOR[Vendor Chunk]
    ENTRY --> APP[App Chunk]
    
    VENDOR --> VUE[Vue/Nuxt Core]
    VENDOR --> UI[UI Library]
    
    APP --> ROUTE[Route Chunk]
    ROUTE --> |Lazy Load| DYNAMIC[Dynamic Imports]
    
    DYNAMIC --> COMP[Heavy Components]
    DYNAMIC --> LIB[Specific Libs]
```

### 1. Tree Shaking

```typescript
// ❌ MAL: Importa toda la librería
import _ from 'lodash';

// ✅ BIEN: Importa solo lo necesario
import debounce from 'lodash/debounce';
```

### 2. Code Splitting (Rutas)

```typescript
// nuxt.config.ts - Automático en Nuxt
// Cada página es un chunk separado

// Para componentes pesados:
const HeavyEditor = defineAsyncComponent(() => 
  import('~/components/HeavyEditor.vue')
);
```

### 3. Lazy Loading de Componentes

```vue
<template>
  <LazyHeavyChart v-if="showChart" :data="chartData" />
</template>

<script setup>
// Nuxt auto-prefija "Lazy" para loading diferido
const showChart = ref(false);
</script>
```

---

## Configuración Vite

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  vite: {
    build: {
      rollupOptions: {
        output: {
          manualChunks: {
            'vendor-vue': ['vue', 'vue-router', 'pinia'],
            'vendor-supabase': ['@supabase/supabase-js'],
            'vendor-stripe': ['@stripe/stripe-js']
          }
        }
      },
      chunkSizeWarningLimit: 500
    }
  }
})
```

---

## Análisis de Bundle

```bash
# Generar reporte visual
npx nuxi analyze

# Alternativa: Webpack Bundle Analyzer
ANALYZE=true npm run build
```

### Ejemplo de Reporte

```
┌──────────────────────┬──────────┬──────────┐
│ Chunk                │ Raw Size │ Gzipped  │
├──────────────────────┼──────────┼──────────┤
│ vendor-vue           │ 180 KB   │ 62 KB    │
│ vendor-supabase      │ 120 KB   │ 38 KB    │
│ pages/index          │ 45 KB    │ 15 KB    │
│ pages/dashboard      │ 85 KB    │ 28 KB    │
└──────────────────────┴──────────┴──────────┘
```

---

## CI/CD Check

```yaml
# .github/workflows/ci.yml
- name: Check Bundle Size
  run: |
    npm run build
    BUNDLE_SIZE=$(du -sk .output/public/_nuxt/*.js | awk '{sum+=$1} END {print sum}')
    if [ $BUNDLE_SIZE -gt 600 ]; then
      echo "❌ Bundle demasiado grande: ${BUNDLE_SIZE}KB"
      exit 1
    fi
```

---

## Relaciones

- Define budgets en: [[Proyecto OnlyCarNLD/Datos/2.17.1 Core_Vitals_Budget|Core Vitals]]
- Complementa: [[Proyecto OnlyCarNLD/Datos/2.17.3 Image_Optimization|Imágenes]]
- Ejecuta en: [[Proyecto OnlyCarNLD/Datos/2.7.3 CI_CD_Pipeline|Pipeline CI/CD]]

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.17. Performance_Strategy]]   |
| -------------------- | -------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.17.1 Core_Vitals_Budget]]    |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.17.3 Image_Optimization]]    |

---
