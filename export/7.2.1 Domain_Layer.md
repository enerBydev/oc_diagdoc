---
id: 7.2.1
title: Capa de Dominio
parent: '7.2'
breadcrumb: 0 → 7.0 → 7.2 → 7.2.1
type: hoja
status: activo
last_updated: 2026-01-29 15:31
file_create: 2026-01-21 12:36
domain:
- domain
- entities
- value-objects
summary: Entities, Value Objects y Domain Services del núcleo de negocio.
content_hash: b0610ef22a292644
---

# 7.2.1 Capa de Dominio

> El corazón del sistema: lógica de negocio pura sin dependencias externas.

---

## Componentes

| Tipo | Descripción | Ejemplo |
|------|-------------|---------|
| **Entity** | Objeto con identidad única | Cita, Operador, Cliente |
| **Value Object** | Objeto inmutable por valor | Ubicacion, Precio, Horario |
| **Domain Service** | Lógica que no pertenece a una entidad | PricingService |
| **Domain Event** | Evento de dominio | CitaCreada, PagoCompletado |

---

## Entities OnlyCar

```typescript
// domain/entities/Cita.ts
export class Cita {
  constructor(
    public readonly id: string,
    public readonly clienteId: string,
    public readonly servicioId: string,
    public readonly ubicacion: Ubicacion,
    public readonly fechaHora: Date,
    private _estado: EstadoCita = 'pendiente'
  ) {}
  
  get estado(): EstadoCita { return this._estado; }
  
  aceptar(operadorId: string): void {
    if (this._estado !== 'pendiente') {
      throw new DomainError('Solo citas pendientes pueden aceptarse');
    }
    this._estado = 'aceptada';
  }
  
  cancelar(motivo: string): void {
    if (['completada', 'cancelada'].includes(this._estado)) {
      throw new DomainError('Cita no puede cancelarse');
    }
    this._estado = 'cancelada';
  }
}
```

---

## Value Objects

```typescript
// domain/value-objects/Ubicacion.ts
export class Ubicacion {
  constructor(
    public readonly lat: number,
    public readonly lng: number,
    public readonly direccion?: string
  ) {
    if (lat < -90 || lat > 90) throw new Error('Latitud inválida');
    if (lng < -180 || lng > 180) throw new Error('Longitud inválida');
  }
  
  equals(other: Ubicacion): boolean {
    return this.lat === other.lat && this.lng === other.lng;
  }
  
  distanceTo(other: Ubicacion): number {
    return haversine(this, other);
  }
}
```

---

## Navegación

| ⬆️ Padre | [[Proyecto OnlyCarNLD/Datos/7.2 Clean_Architecture_DDD]] |
|----------|-------------------------------|
| ➡️ Siguiente | [[Proyecto OnlyCarNLD/Datos/7.2.2 Application_Layer]] |

---
