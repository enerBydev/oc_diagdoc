---
id: 1.3.4
title: Tipos de Mensajes
parent: '1.3'
breadcrumb: 0 ‚Üí 1.0 ‚Üí 1.3 ‚Üí 1.3.4
type: hoja
status: activo
domain: comunicacion
summary: Cat√°logo de tipos de mensajes soportados con estructura JSON, eventos de
  sistema y componentes UI para renderizado.
version: 1.0
last_updated: 2026-01-29 16:01
file_create: 2025-12-23 10:59
actors:
- sistema
dependencies:
- 1.3.1 chat_arquitectura
affects:
- 1.3.X chat
content_hash: da0fb23ff37058c5
---

# 1.3.4 Tipos de Mensajes

Cat√°logo de tipos de mensajes soportados en el sistema de chat.

---

## Tipos Disponibles

| Tipo | C√≥digo | Canal | Descripci√≥n |
|------|--------|-------|-------------|
| Texto | `text` | Todos | Mensaje de texto plano |
| Imagen | `image` | Todos | Foto individual |
| CARD Servicio | `card_service` | OPC | Documentaci√≥n antes/despu√©s |
| CARD Pago | `card_payment` | Todos | Link de pago Stripe |
| CARD Contrato | `card_contract` | ADM | Propuesta/contrato |
| CARD Ubicaci√≥n | `card_location` | OPC | Mapa con GPS |
| Archivo | `file` | ADM | PDF, documentos |
| Sistema | `system` | Todos | Notificaciones autom√°ticas |

---

## Estructura JSON de Cada Tipo

### Texto (`text`)

```json
{
  "type": "text",
  "content": {
    "text": "Hola, voy en camino üöó"
  }
}
```

### Imagen (`image`)

```json
{
  "type": "image",
  "content": {
    "url": "https://r2.onlycar.mx/images/abc123.jpg",
    "thumbnail_url": "https://r2.onlycar.mx/thumbs/abc123.jpg",
    "caption": "Vista frontal del veh√≠culo",
    "width": 1920,
    "height": 1080
  }
}
```

### CARD Servicio (`card_service`)

```json
{
  "type": "card_service",
  "content": {
    "service_id": "uuid-del-servicio",
    "service_name": "Lavado Express",
    "service_date": "2025-01-15T14:30:00Z",
    "operator_name": "Carlos Mart√≠nez",
    "status": "completed",
    "photos_before": [
      { "url": "...", "thumbnail": "..." }
    ],
    "photos_after": [
      { "url": "...", "thumbnail": "..." }
    ],
    "operator_comment": "Cliente pidi√≥ atenci√≥n especial en rines",
    "actions": [
      { "label": "Ver detalles", "action": "view_service", "service_id": "..." }
    ]
  }
}
```

### CARD Pago (`card_payment`)

```json
{
  "type": "card_payment",
  "content": {
    "service_id": "uuid-del-servicio",
    "amount": 350,
    "currency": "MXN",
    "status": "pending",
    "payment_link": "https://pay.stripe.com/...",
    "expires_at": "2025-01-16T14:30:00Z",
    "actions": [
      { "label": "Pagar ahora", "action": "open_link", "url": "..." }
    ]
  }
}
```

### CARD Contrato (`card_contract`)

```json
{
  "type": "card_contract",
  "content": {
    "contract_id": "uuid-del-contrato",
    "contract_number": "CONT-B2B-2025-01-15-XYZ123",
    "type": "proposal|pending_signature|signed",
    "company_name": "XYZ Corp",
    "summary": {
      "package": "Express Flotilla",
      "vehicles": 15,
      "price_per_unit": 224,
      "discount_applied": "35%",
      "monthly_estimate": 3360
    },
    "valid_until": "2025-02-15",
    "actions": [
      { "label": "Ver detalles", "action": "view_contract", "contract_id": "..." },
      { "label": "Firmar", "action": "sign_contract", "url": "mifiel.com/..." }
    ]
  }
}
```

### CARD Ubicaci√≥n (`card_location`)

```json
{
  "type": "card_location",
  "content": {
    "latitude": 27.5067,
    "longitude": -99.5075,
    "address": "Blvd. Colosio #456, Nuevo Laredo",
    "eta_minutes": 5,
    "is_live": true,
    "map_preview_url": "https://static-maps.service/..."
  }
}
```

### Archivo (`file`)

```json
{
  "type": "file",
  "content": {
    "url": "https://r2.onlycar.mx/docs/propuesta.pdf",
    "filename": "Propuesta_XYZ_Corp.pdf",
    "file_type": "application/pdf",
    "file_size": 245760
  }
}
```

### Sistema (`system`)

```json
{
  "type": "system",
  "content": {
    "event": "contract_signed",
    "text": "‚úÖ El contrato ha sido firmado por ambas partes",
    "metadata": {
      "contract_id": "uuid-del-contrato"
    }
  }
}
```

---

## Eventos de Sistema

| Evento | Mensaje | Canal |
|--------|---------|-------|
| `service_confirmed` | "Cita confirmada para [fecha]" | OPC |
| `operator_assigned` | "[Operador] ha sido asignado" | OPC |
| `operator_on_way` | "[Operador] va en camino" | OPC |
| `operator_arrived` | "[Operador] ha llegado" | OPC |
| `service_started` | "Servicio iniciado" | OPC |
| `service_completed` | "‚úÖ Servicio completado" | OPC |
| `payment_received` | "üí∞ Pago de $[X] recibido" | Todos |
| `contract_sent` | "üìù Contrato enviado para firma" | ADM |
| `contract_signed` | "‚úÖ Contrato firmado" | ADM |
| `contract_expiring` | "‚ö†Ô∏è Contrato vence en [X] d√≠as" | ADM |

---

## Componentes UI

### Renderizado de CARDs

```vue
<!-- MessageCard.vue -->
<template>
  <div class="message-card" :class="cardType">
    <component :is="cardComponent" :content="content" />
  </div>
</template>

<script setup>
const cardComponents = {
  card_service: 'ServiceCard',
  card_payment: 'PaymentCard',
  card_contract: 'ContractCard',
  card_location: 'LocationCard'
};
</script>
```

---

## Validaciones

| Tipo | Validaci√≥n |
|------|------------|
| `text` | M√°ximo 2000 caracteres |
| `image` | Max 10MB, formatos: jpg, png, webp |
| `file` | Max 25MB, formatos: pdf, doc, xls |
| `card_*` | Schema JSON v√°lido |

---

## Navegaci√≥n

| ‚¨ÜÔ∏è Padre             | [[Proyecto OnlyCarNLD/Datos/1.3. comunicacion]]             |
| -------------------- | --------------------------------- |
| ‚¨ÖÔ∏è Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/1.3.3 chat_operador_cliente]]   |
| ‚û°Ô∏è Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/1.3.5 notificaciones]]          |
| üîó Ver tambi√©n       | [[Proyecto OnlyCarNLD/Datos/1.3.1 chat_arquitectura]]       |

---
