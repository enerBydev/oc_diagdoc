---
id: 3.1.6
title: Datos Iniciales Seed
parent: '3.1'
breadcrumb: 0 → 3.0 → 3.1 → 3.1.6
type: hoja
status: activo
last_updated: 2026-01-29 15:31
file_create: 2025-12-17 11:38
domain:
- sql
- seed
- migracion
actors:
- admin
- desarrollador
summary: 'Script SQL para poblar la base de datos con datos iniciales.

  Servicios, paquetes, descuentos, empresas desde config_precios_v3.2.1.'
content_hash: 1822288f5b05e162
---

# 3.1.6 Datos Iniciales (Seed)

**Propósito:** Poblar las tablas con los datos del JSON v3.2.1  
**Ejecutar:** Una vez al inicializar la base de datos

---

### Script de Migración

```sql
-- ============================================================
-- SEED: Datos iniciales desde config_precios_v3.2.1
-- Fecha: 2025-12-17
-- ============================================================

-- 1. Configuración del sistema
INSERT INTO config_sistema (
  version, currency, precios_incluyen_iva, formula_descuentos_acumulados,
  descuento_max, descuento_min, precio_min, duracion_minutos_min,
  buffer_minutos_default, redondeo_multiplo,
  factor_base, factor_b2c, factor_b2b
) VALUES (
  '3.2.1', 'MXN', true, '1 - ((1 - d1/100) * (1 - d2/100) * (1 - d3/100))',
  100, 0, 50, 10, 15, 10,
  1.0, 0.7, 0.45
);

-- 2. Servicios
INSERT INTO servicios (codigo, nombre, servicio_minutos, buffer_minutos, precio_base, descripcion, orden) VALUES
  ('lavadoExteriorBasico', 'Lavado Exterior Básico', 20, 15, 290, 'Lavado exterior del vehículo con hidrolavadora, shampoo pH balanceado, limpieza de llantas y neumáticos, y secado con toalla de microfibra', 1),
  ('lavadoExteriorPremium', 'Lavado Exterior Premium', 30, 15, 500, 'Lavado exterior detallado (carrocería, llantas, rines + brillo). No incluye aplicación de cera ni limpieza con clay bar', 2),
  ('limpiezaAspiradoInteriores', 'Limpieza y Aspirado de Interiores', 20, 15, 360, 'Aspirado completo, limpieza de plásticos, tablero, alfombras, y cristales interiores', 3),
  ('lavadoAsientos', 'Lavado de Asientos', 30, 15, 640, 'Limpieza profunda con aspiradora, vapor, y succión de suciedad de asientos y tapicería', 4),
  ('restauracionFaros', 'Restauración de Faros', 10, 15, 430, 'Restauración de faros opacos para mejorar la visibilidad y el aspecto general del vehículo', 5),
  ('restauracionPlasticosVinilos', 'Restauración Plásticos/Vinilos', 10, 15, 430, 'Restauración de plásticos exteriores para devolverles su color original y protegerlos contra el desgaste', 6),
  ('pulidoEnceradoCompleto', 'Pulido y Encerado Completo', 180, 15, 1570, 'Pulido en varias etapas para eliminar defectos de la pintura, seguido de un encerado para proteger el acabado', 7),
  ('proteccionCeramica', 'Protección Cerámica', 240, 15, 3140, 'Aplicación de un recubrimiento cerámico para protección duradera y un acabado de alto brillo', 8),
  ('limpiezaMotor', 'Limpieza de Motor', 20, 15, 500, 'Limpieza segura del compartimento del motor utilizando productos específicos para eliminar grasa y suciedad', 9),
  ('purificacionExtremaInteriores', 'Purificación Extrema de Interiores', 60, 15, 570, 'Eliminación del 99.9% de bacterias, virus y malos olores con tecnología de punta: limpieza profunda con vapor y desinfección con generador de ozono', 10);

-- 3. Escalas de Volumen
INSERT INTO escalas_volumen (codigo, nombre, descripcion) VALUES
  ('estandar', 'Estándar', 'Escala de volumen estándar para flotillas'),
  ('preventrega', 'Pre-Entrega', 'Escala especial para concesionarias');

INSERT INTO escala_rangos (escala_id, min_vehiculos, max_vehiculos, descuento)
SELECT id, 3, 9, 10 FROM escalas_volumen WHERE codigo = 'estandar'
UNION ALL
SELECT id, 10, 19, 15 FROM escalas_volumen WHERE codigo = 'estandar'
UNION ALL
SELECT id, 20, 49, 20 FROM escalas_volumen WHERE codigo = 'estandar'
UNION ALL
SELECT id, 50, NULL, 25 FROM escalas_volumen WHERE codigo = 'estandar'
UNION ALL
SELECT id, 5, 10, 15 FROM escalas_volumen WHERE codigo = 'preventrega'
UNION ALL
SELECT id, 11, 20, 20 FROM escalas_volumen WHERE codigo = 'preventrega'
UNION ALL
SELECT id, 21, NULL, 25 FROM escalas_volumen WHERE codigo = 'preventrega';

-- 4. Paquetes B2C
INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, descripcion, orden)
VALUES
  ('brilloExpress', 'b2c', 'Brillo Express', 40, 15, 360, 'Lavado exterior relámpago con hidrolavadora + aspirado profundo de interiores. Ideal para mantener tu auto impecable sin invertir horas.', 1),
  ('proteccionTotal', 'b2c', 'Protección Total', 140, 15, 710, 'Limpieza exterior + desinfección con ozono y vapor + lavado de asientos. Elimina el 99.9% de bacterias, protege tapicería y devuelve el brillo como nuevo', 2);

-- Paquetes con herencia
INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, hereda_de_id, descripcion, orden)
SELECT 
  'renovacionProfunda', 'b2c', 'Renovación Profunda', 180, 15, 1430, 
  id, 'Limpieza de motor + restauración de faros opacos + desinfección VIP. Elimina el desgaste visible y devuelve ese aspecto de agencia', 3
FROM paquetes WHERE codigo = 'proteccionTotal';

INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, hereda_de_id, descripcion, orden)
SELECT 
  'excelenciaDefinitiva', 'b2c', 'Excelencia Definitiva', 600, 15, 2860, 
  id, 'Pulido profesional + sellador cerámico + renovación integral. Un acabado espejo que repele agua, rayos UV y contaminación por hasta 1 año', 4
FROM paquetes WHERE codigo = 'renovacionProfunda';

-- 5. Paquetes B2B
INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, escala_volumen_id, descripcion, orden)
SELECT 
  'expressFlotilla', 'b2b', 'Express Flotilla', 40, 15, 440,
  ev.id, 'Servicio rápido ideal para mantenimiento regular de flotillas corporativas', 1
FROM escalas_volumen ev WHERE ev.codigo = 'estandar';

INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, escala_volumen_id, descripcion, orden)
SELECT 
  'proteccionCorporativa', 'b2b', 'Protección Corporativa', 140, 15, 890,
  ev.id, 'Servicio completo con desinfección para flotillas ejecutivas y vehículos de alta rotación', 2
FROM escalas_volumen ev WHERE ev.codigo = 'estandar';

INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, hereda_de_id, escala_volumen_id, descripcion, orden)
SELECT 
  'renovacionEmpresarial', 'b2b', 'Renovación Empresarial', 180, 15, 1780,
  p.id, ev.id, 'Renovación profunda para vehículos con desgaste visible o preparación para eventos corporativos', 3
FROM paquetes p, escalas_volumen ev 
WHERE p.codigo = 'proteccionCorporativa' AND ev.codigo = 'estandar';

INSERT INTO paquetes (codigo, tipo, nombre, servicio_minutos, buffer_minutos, precio_base, escala_volumen_id, descripcion, orden)
SELECT 
  'prepPreventrega', 'b2b', 'Preparación Pre-Entrega', 120, 15, 1330,
  ev.id, 'Servicio especializado para concesionarias: preparación de vehículos nuevos antes de entrega a cliente', 4
FROM escalas_volumen ev WHERE ev.codigo = 'preventrega';

-- 6. Relación Paquete-Servicios
-- Brillo Express
INSERT INTO paquete_servicios (paquete_id, servicio_id, es_adicional, orden)
SELECT p.id, s.id, false, 1
FROM paquetes p, servicios s
WHERE p.codigo = 'brilloExpress' AND s.codigo = 'lavadoExteriorBasico';

INSERT INTO paquete_servicios (paquete_id, servicio_id, es_adicional, orden)
SELECT p.id, s.id, false, 2
FROM paquetes p, servicios s
WHERE p.codigo = 'brilloExpress' AND s.codigo = 'limpiezaAspiradoInteriores';

-- Protección Total
INSERT INTO paquete_servicios (paquete_id, servicio_id, es_adicional, orden)
SELECT p.id, s.id, false, ROW_NUMBER() OVER ()
FROM paquetes p, servicios s
WHERE p.codigo = 'proteccionTotal' 
  AND s.codigo IN ('lavadoExteriorPremium', 'limpiezaAspiradoInteriores', 'lavadoAsientos', 'purificacionExtremaInteriores');

-- Renovación Profunda (servicios adicionales)
INSERT INTO paquete_servicios (paquete_id, servicio_id, es_adicional, orden)
SELECT p.id, s.id, true, ROW_NUMBER() OVER ()
FROM paquetes p, servicios s
WHERE p.codigo = 'renovacionProfunda' 
  AND s.codigo IN ('limpiezaMotor', 'restauracionFaros', 'restauracionPlasticosVinilos');

-- Excelencia Definitiva (servicios adicionales)
INSERT INTO paquete_servicios (paquete_id, servicio_id, es_adicional, orden)
SELECT p.id, s.id, true, ROW_NUMBER() OVER ()
FROM paquetes p, servicios s
WHERE p.codigo = 'excelenciaDefinitiva' 
  AND s.codigo IN ('proteccionCeramica', 'pulidoEnceradoCompleto');

-- 7. Descuentos B2C
INSERT INTO descuentos (codigo, segmento, nombre, porcentaje, tipo, uso_maximo, descripcion)
VALUES
  ('BIENVENIDA30', 'b2c', 'Bienvenida Orgánica', 30, 'primeraVez', 1, 'Primer servicio sin código de invitación'),
  ('BIENVENIDA_REFERIDA', 'b2c', 'Bienvenida Referida', 40, 'primeraVez', 1, 'Primer servicio con código de invitación de cliente existente'),
  ('FLOTILLA20', 'b2c', 'Flotilla Personal', 20, 'volumen', NULL, 'Descuento por traer 3+ vehículos en misma cita'),
  ('PADRINO', 'b2c', 'Crédito Padrino', 20, 'credito', NULL, 'Crédito ganado por cada referido que completa su primer servicio'),
  ('CORP15', 'b2c', 'Empleado Corporativo', 15, 'permanente', NULL, 'Descuento permanente para empleados de empresas cliente B2B');

-- Actualizar PADRINO con campos adicionales
UPDATE descuentos SET uso_por_servicio = 1, expiracion_meses = 6 WHERE codigo = 'PADRINO';

-- 8. Descuentos B2B
INSERT INTO descuentos (codigo, segmento, nombre, porcentaje, tipo, descripcion)
VALUES
  ('CONTRATO_MENSUAL', 'b2b', 'Suscripción Corporativa', 5, 'recurrente', 'Descuento adicional por compromiso de contrato mensual'),
  ('LEALTAD_ANUAL', 'b2b', 'Cliente Anual Preferente', 2, 'lealtad', 'Descuento adicional por lealtad de 12+ meses consecutivos');

-- 9. Requisitos de descuentos
INSERT INTO descuento_requisitos (descuento_id, requisito)
SELECT id, 'clienteNuevoSinReferido' FROM descuentos WHERE codigo = 'BIENVENIDA30'
UNION ALL
SELECT id, 'clienteNuevoConReferido' FROM descuentos WHERE codigo = 'BIENVENIDA_REFERIDA'
UNION ALL
SELECT id, 'minimo3VehiculosMismaCita' FROM descuentos WHERE codigo = 'FLOTILLA20'
UNION ALL
SELECT id, 'creditoDisponible' FROM descuentos WHERE codigo = 'PADRINO'
UNION ALL
SELECT id, 'empleadoEmpresaB2B' FROM descuentos WHERE codigo = 'CORP15'
UNION ALL
SELECT id, 'verificacionEmail' FROM descuentos WHERE codigo = 'CORP15'
UNION ALL
SELECT id, 'contratoMinimo3Meses' FROM descuentos WHERE codigo = 'CONTRATO_MENSUAL'
UNION ALL
SELECT id, 'cantidadMinimaGarantizada' FROM descuentos WHERE codigo = 'CONTRATO_MENSUAL'
UNION ALL
SELECT id, 'contratoActivo12MesesConsecutivos' FROM descuentos WHERE codigo = 'LEALTAD_ANUAL';

-- 10. Compatibilidad de descuentos
-- Excluyentes: BIENVENIDA30 y BIENVENIDA_REFERIDA
INSERT INTO descuento_compatibilidad (descuento_a_id, descuento_b_id, tipo)
SELECT a.id, b.id, 'excluyente'
FROM descuentos a, descuentos b
WHERE a.codigo = 'BIENVENIDA30' AND b.codigo = 'BIENVENIDA_REFERIDA';

-- Excluyentes: Primera vez con acumulables
INSERT INTO descuento_compatibilidad (descuento_a_id, descuento_b_id, tipo)
SELECT a.id, b.id, 'excluyente'
FROM descuentos a, descuentos b
WHERE a.codigo IN ('BIENVENIDA30', 'BIENVENIDA_REFERIDA') 
  AND b.codigo IN ('FLOTILLA20', 'PADRINO');

-- Compatibles: CORP15 con acumulables
INSERT INTO descuento_compatibilidad (descuento_a_id, descuento_b_id, tipo)
SELECT a.id, b.id, 'compatible'
FROM descuentos a, descuentos b
WHERE a.codigo = 'CORP15' AND b.codigo IN ('FLOTILLA20', 'PADRINO');

-- Excluyentes entre sí: acumulables
INSERT INTO descuento_compatibilidad (descuento_a_id, descuento_b_id, tipo)
SELECT a.id, b.id, 'excluyente'
FROM descuentos a, descuentos b
WHERE a.codigo = 'FLOTILLA20' AND b.codigo = 'PADRINO';

-- 11. Beneficios adicionales de descuentos
INSERT INTO descuento_beneficios (descuento_id, beneficio, valor)
SELECT id, 'prioridadAgenda48hrs', '48' FROM descuentos WHERE codigo = 'CORP15'
UNION ALL
SELECT id, 'tarjetasReferido10', '10' FROM descuentos WHERE codigo = 'CORP15'
UNION ALL
SELECT id, 'facturacionEmpresa', 'true' FROM descuentos WHERE codigo = 'CORP15'
UNION ALL
SELECT id, 'generaCredito', 'PADRINO' FROM descuentos WHERE codigo = 'BIENVENIDA_REFERIDA';

-- 12. Formatos de identificador
INSERT INTO formatos_identificador (codigo, formato, ejemplo, descripcion)
VALUES
  ('clienteB2C', 'B2C-NLD-{secuencial:4}', 'B2C-NLD-0001', 'ID para clientes consumidor final'),
  ('clienteB2CEmpleado', 'B2C-CORP-{empresaCodigo}-{secuencial:3}', 'B2C-CORP-BYD-001', 'ID para empleados de empresas B2B'),
  ('clienteB2B', 'B2B-{empresaCodigo}-NLD-{secuencial:3}', 'B2B-BYD-NLD-001', 'ID para empresas cliente'),
  ('codigoReferidoCliente', 'NLD-C-{alfanumerico:6}', 'NLD-C-A3X9K2', 'Código de referido para clientes'),
  ('codigoReferidoEmpleado', 'NLD-B-{alfanumerico:6}', 'NLD-B-F7M2P4', 'Código de referido para empleados Corporate+');

-- 13. Empresas registradas
INSERT INTO empresas (codigo, nombre, activo, tipo_contrato, corporate_plus_activo, prioridad_agenda_horas, tarjetas_referido)
VALUES
  ('BYD', 'BYD Nuevo Laredo', true, 'mensual', true, 48, 10),
  ('NISSAN', 'Nissan Automotriz', true, 'mensual', true, 48, 10),
  ('TOYOTA', 'Toyota del Norte', true, 'mensual', true, 48, 10),
  ('HERTZ', 'Hertz Rent a Car', true, 'mensual', true, 48, 10),
  ('BBVA', 'BBVA Bancomer', true, 'anual', true, 48, 10);

-- ============================================================
-- FIN DEL SEED
-- ============================================================
```

---

### Verificación Post-Seed

```sql
-- Verificar totales
SELECT 'config_sistema' as tabla, COUNT(*) as registros FROM config_sistema
UNION ALL
SELECT 'servicios', COUNT(*) FROM servicios
UNION ALL
SELECT 'paquetes', COUNT(*) FROM paquetes
UNION ALL
SELECT 'paquete_servicios', COUNT(*) FROM paquete_servicios
UNION ALL
SELECT 'escalas_volumen', COUNT(*) FROM escalas_volumen
UNION ALL
SELECT 'escala_rangos', COUNT(*) FROM escala_rangos
UNION ALL
SELECT 'descuentos', COUNT(*) FROM descuentos
UNION ALL
SELECT 'descuento_requisitos', COUNT(*) FROM descuento_requisitos
UNION ALL
SELECT 'descuento_compatibilidad', COUNT(*) FROM descuento_compatibilidad
UNION ALL
SELECT 'descuento_beneficios', COUNT(*) FROM descuento_beneficios
UNION ALL
SELECT 'formatos_identificador', COUNT(*) FROM formatos_identificador
UNION ALL
SELECT 'empresas', COUNT(*) FROM empresas;
```

**Resultado esperado:**

| tabla | registros |
|-------|-----------|
| config_sistema | 1 |
| servicios | 10 |
| paquetes | 8 |
| paquete_servicios | ~20 |
| escalas_volumen | 2 |
| escala_rangos | 7 |
| descuentos | 7 |
| descuento_requisitos | 9 |
| descuento_compatibilidad | ~8 |
| descuento_beneficios | 4 |
| formatos_identificador | 5 |
| empresas | 5 |

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/3.1. Logica_Negocio_Core]]                   |
| -------------------- | ------------------------------------ |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/3.1.5 api_logica_negocio]]         |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/3.1.7 sistema_costos]]             |

---
