---
id: 1.1.7.3
title: Formulario de Contrato
parent: 1.1.7
breadcrumb: 0 → 1.0 → 1.1 → 1.1.7 → 1.1.7.3
type: formulario
status: activo
last_updated: 2026-01-29 15:32
file_create: 2025-12-23 10:54
domain:
- contratos
- formularios
- validacion
summary: '6 pasos del formulario dinámico para contratos B2B. Campos,

  validaciones, cálculo automático de descuentos, JSON para PDFme.

  '
content_hash: b6b40da3a7d6d4a4
---

# 1.1.7.3 Formulario de Contrato

> Campos del formulario dinámico que el Admin completa para generar un contrato.

---

## Estructura del Formulario

| Paso | Contenido |
|------|-----------|
| 1 | Datos del Cliente |
| 2 | Servicios Contratados |
| 3 | Condiciones Comerciales |
| 4 | Vigencia y Pago |
| 5 | Corporate+ (opcional) |
| 6 | Revisión y Generación |

---

## Paso 1: Datos del Cliente

| Campo | Tipo | Obligatorio | Validación |
|-------|------|-------------|------------|
| Razón Social | `text` | ✅ | Mínimo 5 caracteres |
| RFC | `text` | ✅ | Formato RFC válido |
| Representante Legal | `text` | ✅ | Nombre completo |
| Email Representante | `email` | ✅ | Email válido |
| Teléfono | `tel` | ✅ | 10 dígitos |
| Domicilio Fiscal | `textarea` | ✅ | Dirección completa |

**Autocompletado:** Si cliente existe, campos se llenan automáticamente.

---

## Paso 2: Servicios Contratados

| Campo | Tipo | Obligatorio | Opciones |
|-------|------|-------------|----------|
| Paquete | `select` | ✅ | Express Flotilla, Protección Corporativa, Personalizado |
| Vehículos/mes | `number` | ✅ | Mínimo 1 |
| Frecuencia | `select` | ✅ | Semanal, Quincenal, Mensual, Por demanda |
| Servicios adicionales | `multiselect` | ❌ | Lista de servicios extra |

### Si Paquete = "Personalizado"

| Campo | Tipo | Obligatorio |
|-------|------|-------------|
| Servicios incluidos | `multiselect` | ✅ |
| Descripción personalizada | `textarea` | ✅ |


---

## Paso 3: Condiciones Comerciales

| Campo | Tipo | Obligatorio | Notas |
|-------|------|-------------|-------|
| Precio unitario base | `currency` | ✅ | Calculado según paquete |
| Descuento volumen | `readonly` | Auto | Según tabla de volumen |
| Descuento contrato | `checkbox` | ❌ | +10% si aplica |
| Descuento adicional | `number (%)` | ❌ | Negociación especial |
| Precio final unitario | `readonly` | Auto | Calculado con descuentos |
| Facturación estimada/mes | `readonly` | Auto | Precio × Vehículos |

### Cálculo Automático de Descuentos

```javascript
// Lógica de cálculo
descuento_volumen = getDescuentoVolumen(vehiculos_mes);
// 3-9: 20%, 10-19: 25%, 20-49: 30%, 50+: 35%

descuento_total = 1 - ((1 - descuento_volumen) * 
                       (1 - descuento_contrato) * 
                       (1 - descuento_adicional));

precio_final = precio_base * (1 - descuento_total);
facturacion_estimada = precio_final * vehiculos_mes;
```

---

## Paso 4: Vigencia y Pago

| Campo | Tipo | Obligatorio | Opciones |
|-------|------|-------------|----------|
| Fecha inicio | `date` | ✅ | Mínimo: hoy |
| Vigencia | `select` | ✅ | 3, 6, 12 meses |
| Fecha vencimiento | `readonly` | Auto | Calculada |
| Renovación automática | `toggle` | ✅ | Sí / No |
| Modalidad facturación | `select` | ✅ | Mensual, Por servicio, Quincenal |
| Método de pago | `select` | ✅ | Transferencia, Link Stripe, Tarjeta |
| Plazo de pago | `select` | ✅ | 15, 30 días |

### Lugar de Servicio

| Campo | Tipo | Obligatorio |
|-------|------|-------------|
| Tipo de ubicación | `multiselect` | ✅ |
| Dirección principal | `textarea` | Condicional |
| Direcciones adicionales | `repeater` | ❌ |

---

## Paso 5: Programa Corporate+ (Opcional)

| Campo | Tipo | Obligatorio |
|-------|------|-------------|
| Activar Corporate+ | `toggle` | ❌ |
| Empleados elegibles | `select` | Condicional |
| Lista de empleados | `file (CSV)` | ❌ |

### Formato CSV de Empleados

```csv
nombre_completo,email_corporativo,telefono
Juan Pérez,juan@empresa.com,8686001234
María López,maria@empresa.com,8686005678
```

---

## Paso 6: Revisión y Generación

| Sección | Contenido |
|---------|-----------|
| Resumen del contrato | Datos principales en tabla |
| Preview PDF | Vista previa del documento |
| Validaciones | Lista de errores o advertencias |
| Acciones | Guardar borrador, Generar PDF, Enviar a firma |

### Estados de Acción

| Botón | Resultado |
|-------|-----------|
| **Guardar Borrador** | Guarda sin generar PDF, estado `draft` |
| **Generar PDF** | PDFme genera documento, estado permanece `draft` |
| **Enviar a Firma** | Envía a Mifiel, estado → `pending_signature` |

---

## JSON del Formulario → PDFme

```json
{
  "cliente": {
    "razon_social": "Empresa XYZ S.A. de C.V.",
    "rfc": "XYZ123456ABC",
    "representante": "Juan Carlos Pérez López",
    "email": "jperez@empresaxyz.com",
    "telefono": "8686123456",
    "domicilio": "Av. Reforma #123, Col. Centro, Nuevo Laredo"
  },
  "servicios": {
    "paquete": "express_flotilla",
    "vehiculos_mes": 15,
    "frecuencia": "semanal",
    "servicios_adicionales": ["pulido", "interior_profundo"]
  },
  "comercial": {
    "precio_base": 350,
    "descuento_volumen": 0.25,
    "descuento_contrato": 0.10,
    "descuento_adicional": 0.05,
    "precio_final": 224,
    "facturacion_mensual": 3360
  },
  "vigencia": {
    "fecha_inicio": "2025-01-01",
    "meses": 12,
    "fecha_vencimiento": "2025-12-31",
    "renovacion_auto": true
  },
  "pago": {
    "modalidad": "mensual",
    "metodo": "stripe",
    "plazo_dias": 30
  },
  "ubicacion": {
    "tipo": ["estacionamiento_empresa"],
    "direccion_principal": "Blvd. Colosio #456, Parque Industrial"
  },
  "corporate_plus": {
    "activo": true,
    "elegibles": "todos",
    "empleados": [...]
  }
}
```


---

## Validaciones

| Campo | Validación | Mensaje de Error |
|-------|------------|------------------|
| RFC | Formato válido | "RFC inválido. Verifique el formato." |
| Email | Formato válido | "Email inválido." |
| Fecha inicio | ≥ Hoy | "La fecha de inicio debe ser hoy o posterior." |
| Vehículos | ≥ 1 | "Debe especificar al menos 1 vehículo." |
| Precio base | > 0 | "El precio debe ser mayor a 0." |

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/1.1.7 contratos_b2b]]            |
| -------------------- | ---------------------------------- |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/1.1.7.2 plantilla_contrato]]     |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/1.1.7.4 generacion_pdfme]]       |

---
