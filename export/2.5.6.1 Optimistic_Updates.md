---
id: 2.5.6.1
title: Optimistic Updates
parent: 2.5.6
breadcrumb: 0 → 2.0 → 2.5 → 2.5.6 → 2.5.6.1
type: guia
children_count: 0
descendants_count: 0
status: activo
domain:
- frontend
- ux
- optimistic-ui
- pinia
actors:
- desarrollador
- ux-designer
summary: 'Patrón de UI optimista: Actualizar la interfaz instantáneamente antes de
  la confirmación del servidor.'
last_updated: 2026-01-29 15:32
file_create: 2026-01-23 02:45
content_hash: 01f126976dca0fff
---

# 2.5.6.1 Optimistic Updates

> UX instantánea: El usuario nunca debe esperar por el loading spinner en acciones triviales.

---

## El Concepto

1. **Trigger:** Usuario hace clic en "Like" o "Guardar".
2. **Update UI:** Asumimos éxito y actualizamos el estado local INSTANTÁNEAMENTE.
3. **Request:** Enviamos la petición al servidor en segundo plano.
4. **Rollback:** Si falla, revertimos el cambio y mostramos error (Toast).

---

## Implementación con Pinia

```typescript
// stores/vehiculos.ts
export const useVehiculosStore = defineStore('vehiculos', () => {
  const vehiculos = ref<Vehiculo[]>([]);

  async function updateAlias(id: string, newAlias: string) {
    // 1. Snapshot del estado anterior (para rollback)
    const previousVehiculos = JSON.parse(JSON.stringify(vehiculos.value));
    
    // 2. Update Optimista
    const target = vehiculos.value.find(v => v.id === id);
    if (target) target.alias = newAlias;
    
    try {
      // 3. Request Real
      const { error } = await supabase
        .from('vehiculos')
        .update({ alias: newAlias })
        .eq('id', id);
        
      if (error) throw error;
      
    } catch (e) {
      // 4. Rollback en error
      vehiculos.value = previousVehiculos;
      showToast('Error al actualizar alias', 'error');
    }
  }
  
  return { vehiculos, updateAlias };
});
```

---

## Casos de Uso Aprobados

| Acción | ¿Optimistic? | Razón |
|--------|--------------|-------|
| Toggle Favorito | ✅ SÍ | Bajo riesgo, alta frecuencia |
| Editar texto simple | ✅ SÍ | Reversible fácilmente |
| Eliminar item lista | ✅ SÍ | Sensación de limpieza inmediata |
| **Realizar Pago** | ❌ NO | Requiere confirmación bancaria real |
| **Agendar Cita** | ❌ NO | Requiere validación de disponibilidad backend |

---

## Feedback Visual

Aunque la UI ya cambió, podemos indicar sutilmente que está "sincronizando":

- Icono de nube con puntitos.
- Borde naranja que pasa a verde.
- Opacidad reducida hasta confirmación (para deletes).

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.5.6 Data_Fetching]]       |
| -------------------- | ----------------------------- |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.5.6.2 Infinite_Scroll]]   |

---
