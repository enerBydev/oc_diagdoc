---
id: 2.10.2
title: Conflict Resolution
parent: '2.10'
breadcrumb: 0 → 2.0 → 2.10 → 2.10.2
type: especificacion
domain:
- offline
- conflictos
- concurrencia
- versioning
status: activo
last_updated: 2026-01-29 15:31
file_create: 2026-01-04 21:38
summary: 'Estrategias para manejar colisiones de datos al sincronizar.

  Last-Write-Wins vs Versionado Semántico de Entidades.'
content_hash: 7c29561da2e1ebf9
---

# 2.10.2 Conflict Resolution

> ¿Qué pasa si el usuario edita su perfil offline y otro admin lo edita online al mismo tiempo?

---

## Estrategia Base: Last-Write-Wins (LWW)

Para la mayoría de los datos no críticos (Perfil, Notas): **La última escritura gana.**

- Cada registro en Supabase tiene columna `updated_at`.
- Al sincronizar, si el `updated_at` del servidor es posterior a la modificación local, se descarta el cambio local y se avisa al usuario: *"Tus cambios han sido sobrescritos por una versión más reciente"*.

---

## Estrategia Crítica: Entidades Versionadas

Para datos financieros o de estado de servicio (Booking):

1. **Optimistic Locking:**
   - Cliente envía `version_id` actual.
   - Servidor verifica: `UPDATE bookings SET status='finished' WHERE id=123 AND version_id=5`.
   - Si no afecta filas (alguien cambió la versión a 6), retorna error `409 Conflict`.

2. **Resolución Manual:**
   - La app recibe el 409.
   - Recupera el estado actual del servidor.
   - Muestra modal al usuario: *"El estado del servicio cambió mientras estabas desconectado. ¿Qué deseas hacer?"*

---

## Navegación

| ⬆️ Padre             | [[Proyecto OnlyCarNLD/Datos/2.10. Estrategia_Offline]]   |
| -------------------- | ------------------------------ |
| ⬅️ Hermano anterior  | [[Proyecto OnlyCarNLD/Datos/2.10.1 Queue_Manager]]       |
| ➡️ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/2.10.3 Estado_Red]]          |

---
