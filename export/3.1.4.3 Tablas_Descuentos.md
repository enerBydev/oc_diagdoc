---
id: 3.1.4.3
title: Tablas Descuentos
parent: 3.1.4
breadcrumb: 0 → 3.0 → 3.1 → 3.1.4 → 3.1.4.3
type: hoja
status: activo
last_updated: 2026-01-29 15:32
file_create: 2026-01-05 12:30
domain:
- sql
- descuentos
actors:
- admin
- desarrollador
summary: 'Tablas de descuentos: catálogo, requisitos, compatibilidad, beneficios.'
content_hash: dd956c1557acec65
---

# 3.1.4.3 Tablas Descuentos

> Sistema completo de descuentos con requisitos y compatibilidad.

---

## descuentos

```sql
CREATE TABLE descuentos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  codigo VARCHAR(50) NOT NULL UNIQUE,
  segmento VARCHAR(10) NOT NULL CHECK (segmento IN ('b2c', 'b2b')),
  nombre VARCHAR(200) NOT NULL,
  porcentaje DECIMAL(5,2) NOT NULL CHECK (porcentaje >= 0 AND porcentaje <= 100),
  tipo VARCHAR(50) NOT NULL,
  uso_maximo INTEGER,
  uso_por_servicio INTEGER DEFAULT 1,
  expiracion_meses INTEGER,
  descripcion TEXT,
  activo BOOLEAN DEFAULT true
);
```

---

## descuento_requisitos

```sql
CREATE TABLE descuento_requisitos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  descuento_id UUID NOT NULL REFERENCES descuentos(id) ON DELETE CASCADE,
  requisito VARCHAR(100) NOT NULL,
  UNIQUE(descuento_id, requisito)
);
```

---

## descuento_compatibilidad

```sql
CREATE TABLE descuento_compatibilidad (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  descuento_a_id UUID NOT NULL REFERENCES descuentos(id) ON DELETE CASCADE,
  descuento_b_id UUID NOT NULL REFERENCES descuentos(id) ON DELETE CASCADE,
  tipo VARCHAR(20) NOT NULL CHECK (tipo IN ('compatible', 'excluyente')),
  UNIQUE(descuento_a_id, descuento_b_id),
  CHECK (descuento_a_id != descuento_b_id)
);
```

---

## descuento_beneficios

```sql
CREATE TABLE descuento_beneficios (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  descuento_id UUID NOT NULL REFERENCES descuentos(id) ON DELETE CASCADE,
  beneficio VARCHAR(100) NOT NULL,
  valor TEXT,
  UNIQUE(descuento_id, beneficio)
);
```

---

## Navegación

| ⬆️ Padre | [[Proyecto OnlyCarNLD/Datos/3.1.4 esquema_sql_logica_negocio]] |
|----------|--------------------------------------|
| ⬅️ Anterior | [[Proyecto OnlyCarNLD/Datos/3.1.4.2 Tablas_Relacionales]] |
| ➡️ Siguiente | [[Proyecto OnlyCarNLD/Datos/3.1.4.4 Tablas_Empresas]] |

---
