---
id: 1.3.2.1
title: CARDs Admin-Cliente
parent: 1.3.2
breadcrumb: 0 â†’ 1.0 â†’ 1.3 â†’ 1.3.2 â†’ 1.3.2.1
type: hoja
status: activo
domain: comunicacion
summary: EspecificaciÃ³n tÃ©cnica de CARDs interactivos del canal Admin-Cliente con
  schemas TypeScript, renderizado UI y almacenamiento SQL.
version: 1.0
last_updated: 2026-01-29 15:31
file_create: 2025-12-23 23:52
actors:
- sistema
dependencies:
- mifiel
affects:
- 1.3.2 chat_admin_cliente
content_hash: 5bea59b5f23ead6e
---

# 1.3.2.1 CARDs del Canal Admin-Cliente

EspecificaciÃ³n tÃ©cnica de los CARDs interactivos.

---

## Arquitectura de CARDs

```typescript
interface CardBase {
  id: string;
  tipo: CardType;
  version: string;
  created_at: string;
  expires_at?: string;
  estado: 'activo' | 'expirado' | 'completado';
}

type CardType = 
  | 'propuesta_comercial'
  | 'contrato_pendiente'
  | 'contrato_firmado'
  | 'renovacion'
  | 'factura'
  | 'pago_recibido';
```

---

## CARD: Propuesta Comercial

### Schema

```typescript
interface PropuestaCard extends CardBase {
  tipo: 'propuesta_comercial';
  data: {
    paquete: string;
    vehiculos_mes: number;
    precio_unitario: number;
    descuento_aplicado: number;
    facturacion_mensual: number;
    iva_incluido: boolean;
    vigencia_dias: number;
  };
  acciones: ['ver_detalles', 'tengo_dudas', 'aceptar'];
}
```

### Renderizado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š PROPUESTA COMERCIAL                           [id: PRO-001] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Paquete: {paquete}                                             â”‚
â”‚  VehÃ­culos: {vehiculos_mes}/mes                                 â”‚
â”‚  Precio unitario: ${precio_unitario} MXN                        â”‚
â”‚  Descuento aplicado: {descuento_aplicado}%                      â”‚
â”‚                                                                 â”‚
â”‚  FacturaciÃ³n mensual: ${facturacion_mensual} MXN + IVA          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Ver detalles    â”‚  â”‚ Tengo dudas     â”‚  â”‚ Aceptar         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  VÃ¡lida hasta: {fecha_expiracion}                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Acciones

| AcciÃ³n | Trigger | Efecto |
|--------|---------|--------|
| `ver_detalles` | Click | Abre modal con desglose completo |
| `tengo_dudas` | Click | EnvÃ­a mensaje predefinido + input |
| `aceptar` | Click | Inicia flujo de contrato |

---

## CARD: Contrato Pendiente

### Schema

```typescript
interface ContratoPendienteCard extends CardBase {
  tipo: 'contrato_pendiente';
  data: {
    contrato_id: string;
    empresa_nombre: string;
    vigencia_meses: number;
    mifiel_url: string;
    firmantes: Array<{
      nombre: string;
      email: string;
      firmado: boolean;
      firmado_at?: string;
    }>;
  };
  acciones: ['revisar_contrato', 'firmar_ahora'];
}
```

### Estados de Firmantes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ CONTRATO PENDIENTE                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Firmantes:                                                     â”‚
â”‚  âœ… RenÃ© Mendoza (Admin)        - Firmado 15/01 14:30           â”‚
â”‚  â³ Juan PÃ©rez (Cliente)        - Pendiente                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CARD: Contrato Firmado

```typescript
interface ContratoFirmadoCard extends CardBase {
  tipo: 'contrato_firmado';
  data: {
    contrato_id: string;
    firmado_at: string;
    vigente_hasta: string;
    pdf_url: string;
    mifiel_verificacion_url: string;
  };
  acciones: ['descargar_pdf', 'verificar_firmas'];
}
```

---

## CARD: RenovaciÃ³n

### Schema
```typescript
interface RenovacionCard extends CardBase {
  tipo: 'renovacion';
  data: {
    contrato_actual_id: string;
    fecha_vencimiento: string;
    dias_restantes: number;
    terminos_actuales: {
      paquete: string;
      precio: number;
      vehiculos: number;
    };
    opciones: Array<{
      id: string;
      descripcion: string;
      accion: string;
    }>;
  };
  acciones: ['renovar_igual', 'modificar', 'esperar'];
}
```

---

## Ciclo de Vida

```
Estado: activo
    â”‚
    â”œâ”€â”€ AcciÃ³n ejecutada â†’ Estado: completado
    â”‚
    â””â”€â”€ Fecha expiraciÃ³n â†’ Estado: expirado
```

---

## Almacenamiento

```sql
CREATE TABLE chat_cards (
  id UUID PRIMARY KEY,
  message_id UUID REFERENCES messages(id),
  tipo VARCHAR(50) NOT NULL,
  data JSONB NOT NULL,
  estado VARCHAR(20) DEFAULT 'activo',
  expires_at TIMESTAMPTZ,
  completed_at TIMESTAMPTZ,
  completed_action VARCHAR(50),
  created_at TIMESTAMPTZ DEFAULT now()
);
```

---

## NavegaciÃ³n

| â¬†ï¸ Padre             | [[Proyecto OnlyCarNLD/Datos/1.3.2 chat_admin_cliente]]     |
| -------------------- | -------------------------------- |
| â¡ï¸ Hermano siguiente | [[Proyecto OnlyCarNLD/Datos/1.3.2.2 flujos_negociacion]]   |

---
